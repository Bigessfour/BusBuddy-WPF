<!--
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                                                                          ║
║                                              🔒 BUSBUDDY SYNCFUSION THEME COMPLIANCE REFERENCE 🔒                                                                    ║
║                                                                                                                                                                          ║
║  📋 REQUIRED STANDARDS: This child form MUST follow the universal standards defined in:                                                                                ║
║     - BusBuddy.WPF\Resources\SyncfusionFluentDarkTheme.xaml (Universal Control Standards)                                                                             ║
║     - Documentation\SyncfusionThemeImplementationGuide.md (Implementation Guide)                                                                                       ║
║                                                                                                                                                                          ║
║  🔧 MANDATORY IMPLEMENTATIONS:                                                                                                                                          ║
║     ✅ UserControl Style: BusBuddyUserControlStyle                                                                                                                     ║
║     ✅ Button Controls: Use syncfusion:ButtonAdv with Label property (NOT Content)                                                                                    ║
║     ✅ Data Grid: Use syncfusion:SfDataGrid with BusBuddySfDataGridStyle                                                                                              ║
║     ✅ Input Controls: Use Syncfusion equivalents (ComboBoxAdv, TextBoxExt, etc.)                                                                                     ║
║     ✅ Theme Application:on ALL Syncfusion controls                                                           ║
║     ✅ Color Palette: Use FluentDark brushes defined in SyncfusionFluentDarkTheme.xaml                                                                                ║
║                                                                                                                                                                          ║
║  ⚠️  CRITICAL REMINDERS:                                                                                                                                               ║
║     • NEVER use standard WPF Button - use syncfusion:ButtonAdv                                                                                                        ║
║     • NEVER use Content property on ButtonAdv - use Label property                                                                                                    ║
║     • NEVER use "sf:" namespace prefix - use "syncfusion:" prefix                                                                                                     ║
║     • ALWAYS apply FluentDark theme to maintain visual consistency                                                                                                     ║
║     • ALWAYS reference baseline styles for consistent appearance                                                                                                       ║
║                                                                                                                                                                          ║
║  📚 DEVELOPMENT REFERENCE: See Documentation\SyncfusionThemeImplementationGuide.md for copy-paste templates                                                          ║
║                                                                                                                                                                          ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
-->

<UserControl x:Class="BusBuddy.WPF.Views.StudentListView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:local="clr-namespace:BusBuddy.WPF.Views"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;a ssembly=Syncfusion.SfSkinManager.WPF"
             xmlns:editors="clr-namespace:Syncfusion.Windows.Controls.Input;a ssembly=Syncfusion.SfInput.Wpf"
             mc:I gnorable="d"
             d:D esignHeight="700" d:D esignWidth="1200"
             d:D ataContext="{d:DesignInstance T ype=viewModels:StudentListViewModel}">

    <Grid S tyle="{StaticResource BusBuddyFormContentStyle}">
        <Grid.RowDefinitions>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="*"/>
            <RowDefinition H eight="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.R ow="0" S tyle="{StaticResource BusBuddyFormHeaderStyle}">
            <TextBlock T ext="Student Lists Management"
                       S tyle="{StaticResource BusBuddyTileHeaderStyle}"/>
        </Border>

        <!-- Search and Filter Controls -->
        <Grid Grid.R ow="1" M argin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition W idth="*"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box -->
            <editors:SfTextBoxExt Grid.C olumn="0"
                                   T ext="{Binding SearchText, U pdateSourceTrigger=PropertyChanged}"
                                   W atermark="Search students by name, number, or route..."
                                   S howClearButton="True" Background="{StaticResource ContentBackground}"
                                   F oreground="{StaticResource PrimaryForeground}"
                                   B orderBrush="{StaticResource BorderBrush}"
                                   M argin="0,0,10,0"/>

            <!-- Grade Filter -->
            <syncfusion:ComboBoxAdv Grid.C olumn="1"
                                   W idth="120"
                                   M argin="0,0,10,0"
                                   I temsSource="{Binding AvailableGrades}"
                                   S electedValue="{Binding SelectedGradeFilter}"
                                   D isplayMemberPath="."
                                   S electedValuePath="."
                                   S tyle="{StaticResource StandardComboBoxStyle}" SelectedIndex="0">
            </syncfusion:ComboBoxAdv>

            <!-- Route Filter -->
            <syncfusion:ComboBoxAdv Grid.C olumn="2"
                                   W idth="150"
                                   M argin="0,0,10,0"
                                   I temsSource="{Binding AvailableRoutes}"
                                   S electedValue="{Binding SelectedRouteFilter}"
                                   D isplayMemberPath="RouteName"
                                   S electedValuePath="RouteName"
                                   S tyle="{StaticResource StandardComboBoxStyle}" SelectedIndex="0">
            </syncfusion:ComboBoxAdv>

            <!-- Export Button -->
            <syncfusion:ButtonAdv Grid.C olumn="3"
                                 C ommand="{Binding ExportCommand}"
                                 M argin="0,0,10,0"
                                 P adding="8,4"
                                 S tyle="{StaticResource SecondaryButtonAdvStyle}" ToolTip="Export filtered student list to CSV"
                                 L abel="📊 Export"/>

            <!-- Print Button -->
            <syncfusion:ButtonAdv Grid.C olumn="4"
                                 C ommand="{Binding PrintCommand}"
                                 M argin="0,0,10,0"
                                 P adding="8,4"
                                 S tyle="{StaticResource SecondaryButtonAdvStyle}" ToolTip="Print student list"
                                 L abel="🖨️ Print"/>

            <!-- Refresh Button -->
            <syncfusion:ButtonAdv Grid.C olumn="5"
                                 C ommand="{Binding RefreshCommand}"
                                 S tyle="{StaticResource SecondaryButtonAdvStyle}" ToolTip="Refresh student list"
                                 L abel="⟳ Refresh"/>
        </Grid>

        <!-- Student Statistics Panel -->
        <Border Grid.R ow="2"
                S tyle="{StaticResource BusBuddyDashboardTileStyle}"
                M argin="0,0,0,15">
            <UniformGrid C olumns="4" M argin="15">
                <!-- Total Students -->
                <StackPanel M argin="5">
                    <TextBlock T ext="Total Students"
                               S tyle="{StaticResource BusBuddyTileSubHeaderStyle}"
                               H orizontalAlignment="Center"/>
                    <TextBlock T ext="{Binding TotalStudents}"
                               F ontSize="28" F ontWeight="Bold"
                               F oreground="{StaticResource AccentBrush}"
                               H orizontalAlignment="Center"/>
                </StackPanel>

                <!-- Active Students -->
                <StackPanel M argin="5">
                    <TextBlock T ext="Active Students"
                               S tyle="{StaticResource BusBuddyTileSubHeaderStyle}"
                               H orizontalAlignment="Center"/>
                    <TextBlock T ext="{Binding ActiveStudents}"
                               F ontSize="28" F ontWeight="Bold"
                               F oreground="{StaticResource SuccessBrush}"
                               H orizontalAlignment="Center"/>
                </StackPanel>

                <!-- Students with Routes -->
                <StackPanel M argin="5">
                    <TextBlock T ext="With Routes"
                               S tyle="{StaticResource BusBuddyTileSubHeaderStyle}"
                               H orizontalAlignment="Center"/>
                    <TextBlock T ext="{Binding StudentsWithRoutes}"
                               F ontSize="28" F ontWeight="Bold"
                               F oreground="{StaticResource InfoBrush}"
                               H orizontalAlignment="Center"/>
                </StackPanel>

                <!-- Students without Routes -->
                <StackPanel M argin="5">
                    <TextBlock T ext="Without Routes"
                               S tyle="{StaticResource BusBuddyTileSubHeaderStyle}"
                               H orizontalAlignment="Center"/>
                    <TextBlock T ext="{Binding StudentsWithoutRoutes}"
                               F ontSize="28" F ontWeight="Bold"
                               F oreground="{StaticResource WarningBrush}"
                               H orizontalAlignment="Center"/>
                </StackPanel>
            </UniformGrid>
        </Border>

        <!-- Enhanced Student List Grid -->
        <syncfusion:SfDataGrid Grid.R ow="3"
                               x:N ame="StudentsGrid"
                               I temsSource="{Binding FilteredStudents}"
                               S electedItem="{Binding SelectedStudent, M ode=TwoWay}"
                               S tyle="{StaticResource StandardDataGridStyle}" Background="{StaticResource ContentBackground}"
                               F oreground="{StaticResource PrimaryForeground}"
                               B orderBrush="{StaticResource BorderBrush}"
                               A utoGenerateColumns="False"
                               A llowResizingColumns="True"
                               A llowSorting="True"
                               A llowFiltering="True"
                               A llowGrouping="True"
                               S howGroupDropArea="True"
                               C olumnSizer="Star"
                               S electionMode="Single"
                               S electionUnit="Row"
                               N avigationMode="Row"
                               A llowEditing="False"
                               S howRowHeader="False"
                               E nableDataVirtualization="True"
                               H orizontalAlignment="Stretch"
                               V erticalAlignment="Stretch"
                               R owHeight="40"
                               H eaderRowHeight="45"
                               C ellDoubleTapped="SfDataGrid_CellDoubleTapped">
            <syncfusion:SfDataGrid.Columns>
                <!-- Student Name with Icon -->
                <syncfusion:GridTemplateColumn M appingName="StudentName" H eaderText="Student Name" W idth="180">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel O rientation="Horizontal">
                                <TextBlock T ext="👤" F ontSize="14" V erticalAlignment="Center" M argin="0,0,6,0"/>
                                <TextBlock T ext="{Binding StudentName}"
                                           F ontWeight="SemiBold"
                                           F oreground="{StaticResource PrimaryForeground}"
                                           V erticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>

                <!-- Student Number -->
                <syncfusion:GridTextColumn M appingName="StudentNumber" H eaderText="Student Number" W idth="130"/>

                <!-- Grade with Visual Indicator -->
                <syncfusion:GridTemplateColumn M appingName="Grade" H eaderText="Grade" W idth="80">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border B ackground="{StaticResource AccentBrush}"
                                    C ornerRadius="4" P adding="8,2" M argin="2">
                                <TextBlock T ext="{Binding Grade}"
                                           F ontWeight="SemiBold" F ontSize="11"
                                           F oreground="{StaticResource OnAccentBrush}"
                                           H orizontalAlignment="Center"/>
                            </Border>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>

                <!-- School -->
                <syncfusion:GridTextColumn M appingName="School" H eaderText="School" W idth="150"/>

                <!-- AM Route -->
                <syncfusion:GridTemplateColumn M appingName="AMRoute" H eaderText="AM Route" W idth="120">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel O rientation="Horizontal">
                                <TextBlock T ext="🌅" F ontSize="12" V erticalAlignment="Center" M argin="0,0,4,0"/>
                                <TextBlock T ext="{Binding AMRoute}"
                                           F oreground="{StaticResource InfoBrush}"
                                           V erticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>

                <!-- PM Route -->
                <syncfusion:GridTemplateColumn M appingName="PMRoute" H eaderText="PM Route" W idth="120">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel O rientation="Horizontal">
                                <TextBlock T ext="🌆" F ontSize="12" V erticalAlignment="Center" M argin="0,0,4,0"/>
                                <TextBlock T ext="{Binding PMRoute}"
                                           F oreground="{StaticResource WarningBrush}"
                                           V erticalAlignment="Center"/>
                            </StackPanel>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>

                <!-- Bus Stop -->
                <syncfusion:GridTextColumn M appingName="BusStop" H eaderText="Bus Stop" W idth="130"/>

                <!-- Parent/Guardian -->
                <syncfusion:GridTextColumn M appingName="ParentGuardian" H eaderText="Parent/Guardian" W idth="160"/>

                <!-- Home Phone -->
                <syncfusion:GridTextColumn M appingName="HomePhone" H eaderText="Phone" W idth="120"/>

                <!-- Active Status -->
                <syncfusion:GridTemplateColumn M appingName="Active" H eaderText="Status" W idth="80">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Border B ackground="{Binding Active, C onverter={StaticResource StatusToColorConverter}}"
                                    C ornerRadius="12" P adding="8,3" M argin="2">
                                <TextBlock T ext="{Binding Active, C onverter={StaticResource BooleanToStatusConverter}}"
                                           F ontWeight="SemiBold" F ontSize="10"
                                           F oreground="{StaticResource OnAccentBrush}"
                                           H orizontalAlignment="Center"/>
                            </Border>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>

                <!-- Special Needs Indicator -->
                <syncfusion:GridTemplateColumn M appingName="SpecialNeeds" H eaderText="Special Needs" W idth="100">
                    <syncfusion:GridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock T ext="{Binding SpecialNeeds, C onverter={StaticResource SpecialNeedsToIconConverter}}"
                                       F ontSize="16" H orizontalAlignment="Center"
                                       F oreground="{Binding SpecialNeeds, C onverter={StaticResource SpecialNeedsToColorConverter}}"
                                       T oolTip="{Binding SpecialNeeds, C onverter={StaticResource SpecialNeedsToTooltipConverter}}"/>
                        </DataTemplate>
                    </syncfusion:GridTemplateColumn.CellTemplate>
                </syncfusion:GridTemplateColumn>
            </syncfusion:SfDataGrid.Columns>

            <!-- Enhanced Context Menu -->
            <syncfusion:SfDataGrid.ContextMenu>
                <ContextMenu S tyle="{StaticResource BusBuddyContextMenuStyle}">
                    <MenuItem H eader="👁️ View Details"
                              C ommand="{Binding ViewDetailsCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <MenuItem H eader="✏️ Edit Student"
                              C ommand="{Binding EditStudentCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <MenuItem H eader="🚌 Assign Route"
                              C ommand="{Binding AssignRouteCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <Separator S tyle="{StaticResource BusBuddyContextMenuSeparatorStyle}"/>
                    <MenuItem H eader="📋 Copy to Clipboard"
                              C ommand="{Binding CopyToClipboardCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <MenuItem H eader="📧 Send Email"
                              C ommand="{Binding SendEmailCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <Separator S tyle="{StaticResource BusBuddyContextMenuSeparatorStyle}"/>
                    <MenuItem H eader="🖨️ Print Student Info"
                              C ommand="{Binding PrintStudentCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                    <MenuItem H eader="📊 Generate Report"
                              C ommand="{Binding GenerateReportCommand}"
                              S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                </ContextMenu>
            </syncfusion:SfDataGrid.ContextMenu>
        </syncfusion:SfDataGrid>

        <!-- Action Buttons -->
        <StackPanel Grid.R ow="4"
                    O rientation="Horizontal"
                    H orizontalAlignment="Right"
                    M argin="0,15,0,0">
            <syncfusion:ButtonAdv L abel="➕ Add Student"
                                 C ommand="{Binding AddStudentCommand}"
                                 S tyle="{StaticResource PrimaryButtonAdvStyle}" Margin="5"
                                 T oolTip="Add a new student to the system"/>

            <syncfusion:ButtonAdv L abel="✏️ Edit Selected"
                                 C ommand="{Binding EditStudentCommand}"
                                 S tyle="{StaticResource SecondaryButtonAdvStyle}" Margin="5"
                                 T oolTip="Edit the selected student"/>

            <syncfusion:ButtonAdv L abel="📋 Bulk Actions"
                                 C ommand="{Binding BulkActionsCommand}"
                                 S tyle="{StaticResource SecondaryButtonAdvStyle}" Margin="5"
                                 T oolTip="Perform bulk actions on selected students"/>

            <syncfusion:ButtonAdv L abel="📊 Reports"
                                 C ommand="{Binding ReportsCommand}"
                                 S tyle="{StaticResource InfoButtonAdvStyle}" Margin="5"
                                 T oolTip="Generate various student reports"/>
        </StackPanel>

        <!-- Loading Indicator -->
        <syncfusion:SfBusyIndicator Grid.R ow="0" Grid.R owSpan="5"
                                    I sBusy="{Binding IsBusy}"
                                    S tyle="{StaticResource LoadingIndicatorStyle}" AnimationType="DoubleCircle"
                                    F oreground="{StaticResource AccentBrush}"
                                    B ackground="Transparent">
            <syncfusion:SfBusyIndicator.Content>
                <TextBlock T ext="Loading student data..."
                           F oreground="{StaticResource PrimaryForeground}"
                           F ontSize="16"
                           M argin="0,10,0,0"
                           H orizontalAlignment="Center"/>
            </syncfusion:SfBusyIndicator.Content>
        </syncfusion:SfBusyIndicator>
    </Grid>
</UserControl>

