<!--
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                                                                          ║
║                                              🔒 BUSBUDDY SYNCFUSION THEME COMPLIANCE REFERENCE 🔒                                                                    ║
║                                                                                                                                                                          ║
║  📋 REQUIRED STANDARDS: This child form MUST follow the universal standards defined in:                                                                                ║
║     - BusBuddy.WPF\Resources\SyncfusionFluentDarkTheme.xaml (Universal Control Standards)                                                                             ║
║     - Documentation\SyncfusionThemeImplementationGuide.md (Implementation Guide)                                                                                       ║
║                                                                                                                                                                          ║
║  🔧 MANDATORY IMPLEMENTATIONS:                                                                                                                                          ║
║     ✅ UserControl Style: BusBuddyUserControlStyle                                                                                                                     ║
║     ✅ Button Controls: Use syncfusion:ButtonAdv with Label property (NOT Content)                                                                                    ║
║     ✅ Data Grid: Use syncfusion:SfDataGrid with BusBuddySfDataGridStyle                                                                                              ║
║     ✅ Input Controls: Use Syncfusion equivalents (ComboBoxAdv, TextBoxExt, etc.)                                                                                     ║
║     ✅ Theme Application:on ALL Syncfusion controls                                                           ║
║     ✅ Color Palette: Use FluentDark brushes defined in SyncfusionFluentDarkTheme.xaml                                                                                ║
║                                                                                                                                                                          ║
║  ⚠️  CRITICAL REMINDERS:                                                                                                                                               ║
║     • NEVER use standard WPF Button - use syncfusion:ButtonAdv                                                                                                        ║
║     • NEVER use Content property on ButtonAdv - use Label property                                                                                                    ║
║     • NEVER use "sf:" namespace prefix - use "syncfusion:" prefix                                                                                                     ║
║     • ALWAYS apply FluentDark theme to maintain visual consistency                                                                                                     ║
║     • ALWAYS reference baseline styles for consistent appearance                                                                                                       ║
║                                                                                                                                                                          ║
║  📚 DEVELOPMENT REFERENCE: See Documentation\SyncfusionThemeImplementationGuide.md for copy-paste templates                                                          ║
║                                                                                                                                                                          ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
-->

<UserControl x:Class="BusBuddy.WPF.Views.Student.StudentManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;a ssembly=Syncfusion.SfSkinManager.WPF"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             xmlns:controls="clr-namespace:BusBuddy.WPF.Controls"
             xmlns:converters="clr-namespace:BusBuddy.WPF.Converters"
             xmlns:editors="clr-namespace:Syncfusion.Windows.Controls.Input;a ssembly=Syncfusion.SfInput.Wpf"
             mc:I gnorable="d"
             d:D esignHeight="700" d:D esignWidth="1200"
             d:D ataContext="{d:DesignInstance T ype=viewModels:StudentManagementViewModel}">
    <!-- Local resources removed - all converters now global in App.xaml -->

    <Grid S tyle="{StaticResource BusBuddyFormContentStyle}">
        <Grid.RowDefinitions>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="Auto"/>
            <RowDefinition H eight="*"/>
            <RowDefinition H eight="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.R ow="0" S tyle="{StaticResource BusBuddyFormHeaderStyle}">
            <TextBlock T ext="Student Management"
                   S tyle="{StaticResource BusBuddyTileHeaderStyle}"/>
        </Border>

        <!-- Search and Filter Controls -->
        <Grid Grid.R ow="1" M argin="0,0,0,15">
            <Grid.ColumnDefinitions>
                <ColumnDefinition W idth="*"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
                <ColumnDefinition W idth="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Search Box -->
            <editors:SfTextBoxExt Grid.C olumn="0"
                                   T ext="{Binding SearchText, U pdateSourceTrigger=PropertyChanged}"
                                   W atermark="Search students..."
                                   S howClearButton="True" Background="{StaticResource ContentBackground}"
                                   F oreground="{StaticResource PrimaryForeground}"
                                   B orderBrush="{StaticResource BorderBrush}"
                                   M argin="0,0,10,0"/>

            <!-- Filter Dropdown -->
            <syncfusion:ComboBoxAdv Grid.C olumn="1"
                                   W idth="150"
                                   M argin="0,0,10,0"
                                   S electedValue="{Binding SelectedStatusFilter}"
                                   S tyle="{StaticResource BusBuddyComboBoxAdvStyle}" SelectedIndex="0">
                <syncfusion:ComboBoxItemAdv C ontent="All Students"/>
                <syncfusion:ComboBoxItemAdv C ontent="Active Students"/>
                <syncfusion:ComboBoxItemAdv C ontent="Inactive Students"/>
            </syncfusion:ComboBoxAdv>

            <!-- Grade Filter Dropdown -->
            <syncfusion:ComboBoxAdv Grid.C olumn="2"
                                   W idth="120"
                                   M argin="0,0,10,0"
                                   I temsSource="{Binding AvailableGrades}"
                                   S electedValue="{Binding SelectedGradeFilter}"
                                   D isplayMemberPath="."
                                   S electedValuePath="."
                                   S tyle="{StaticResource BusBuddyComboBoxAdvStyle}" SelectedIndex="0">
            </syncfusion:ComboBoxAdv>

            <!-- School Filter Dropdown -->
            <syncfusion:ComboBoxAdv Grid.C olumn="3"
                                   W idth="150"
                                   M argin="0,0,10,0"
                                   I temsSource="{Binding AvailableSchools}"
                                   S electedValue="{Binding SelectedSchoolFilter}"
                                   D isplayMemberPath="."
                                   S electedValuePath="."
                                   S tyle="{StaticResource BusBuddyComboBoxAdvStyle}" SelectedIndex="0">
            </syncfusion:ComboBoxAdv>

            <!-- Statistics Toggle Button -->
            <syncfusion:ButtonAdv Grid.C olumn="4"
                          I sCheckable="True"
                          I sChecked="{Binding ShowStatistics}"
                          C ommand="{Binding ToggleStatisticsCommand}"
                          M argin="0,0,10,0"
                          P adding="8,4"
                          S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" ToolTip="Show/Hide Statistics"
                          L abel="📊 Statistics"/>

            <!-- Advanced Search Button -->
            <syncfusion:ButtonAdv Grid.C olumn="5"
                    C ommand="{Binding AdvancedSearchCommand}"
                    M argin="0,0,10,0"
                    P adding="8,4"
                    S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" ToolTip="Advanced Search Options"
                    L abel="🔍 Advanced"/>

            <!-- Clear Advanced Search Button -->
            <syncfusion:ButtonAdv Grid.C olumn="6"
                    C ommand="{Binding ClearAdvancedSearchCommand}"
                    M argin="0,0,10,0"
                    P adding="8,4"
                    V isibility="{Binding AdvancedSearchCriteria, C onverter={StaticResource ObjectToVisibilityConverter}}"
                    S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" ToolTip="Clear Advanced Search"
                    L abel="❌ Clear Advanced"/>

            <!-- Refresh Button -->
            <syncfusion:ButtonAdv Grid.C olumn="7"
                    C ommand="{Binding RefreshCommand}"
                    S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" ToolTip="Refresh student list"
                    L abel="⟳ Refresh"/>
        </Grid>

        <!-- Statistics Panel (Collapsible) -->
        <controls:StudentStatisticsPanel
            Grid.R ow="2"
            V isibility="{Binding ShowStatistics, C onverter={StaticResource BooleanToVisibilityConverter}}"
            M argin="0,0,0,15"
            T otalStudents="{Binding TotalStudents}"
            A ctiveStudents="{Binding ActiveStudents}"
            I nactiveStudents="{Binding InactiveStudents}"
            S tudentsWithRoutes="{Binding StudentsWithRoutes}"
            S tudentsWithoutRoutes="{Binding StudentsWithoutRoutes}"
            G radeDistribution="{Binding GradeDistribution}"
            S tatusDistribution="{Binding StatusDistribution}"/>

        <!-- Main Student Grid -->
        <syncfusion:SfDataGrid Grid.R ow="3"
                              I temsSource="{Binding FilteredStudents}"
                              S electedItem="{Binding SelectedStudent, M ode=TwoWay}"
                              S tyle="{StaticResource BusBuddySfDataGridStyle}" Background="{StaticResource ContentBackground}"
                              F oreground="{StaticResource PrimaryForeground}"
                              B orderBrush="{StaticResource BorderBrush}"
                              A utoGenerateColumns="False"
                              A llowResizingColumns="True"
                              A llowSorting="True"
                              A llowFiltering="True"
                              C olumnSizer="Star"
                              S electionMode="Single"
                              S electionUnit="Row"
                              N avigationMode="Row"
                              A llowEditing="False"
                              S howRowHeader="True"
                              E nableDataVirtualization="True"
                              H orizontalAlignment="Stretch"
                              V erticalAlignment="Stretch"
                              R owHeight="40"
                              H eaderRowHeight="45">
            <syncfusion:SfDataGrid.Columns>
                <syncfusion:GridTextColumn M appingName="StudentName" H eaderText="Student Name" W idth="150"/>
                <syncfusion:GridTextColumn M appingName="StudentNumber" H eaderText="Student Number" W idth="120"/>
                <syncfusion:GridTextColumn M appingName="Grade" H eaderText="Grade" W idth="80"/>
                <syncfusion:GridTextColumn M appingName="School" H eaderText="School" W idth="120"/>
                <syncfusion:GridTextColumn M appingName="AMRoute" H eaderText="AM Route" W idth="100"/>
                <syncfusion:GridTextColumn M appingName="PMRoute" H eaderText="PM Route" W idth="100"/>
                <syncfusion:GridTextColumn M appingName="BusStop" H eaderText="Bus Stop" W idth="120"/>
                <syncfusion:GridTextColumn M appingName="ParentGuardian" H eaderText="Parent/Guardian" W idth="150"/>
                <syncfusion:GridTextColumn M appingName="HomePhone" H eaderText="Phone" W idth="120"/>
                <syncfusion:GridCheckBoxColumn M appingName="Active" H eaderText="Active" W idth="80"/>
                <syncfusion:GridCheckBoxColumn M appingName="SpecialNeeds" H eaderText="Special Needs" W idth="100"/>
                <syncfusion:GridTextColumn M appingName="City" H eaderText="City" W idth="100"/>
                <syncfusion:GridTextColumn M appingName="State" H eaderText="State" W idth="80"/>
            </syncfusion:SfDataGrid.Columns>
        </syncfusion:SfDataGrid>

        <!-- Action Buttons -->
        <StackPanel Grid.R ow="4"
                    O rientation="Horizontal"
                    H orizontalAlignment="Right"
                    M argin="0,15,0,0">
            <syncfusion:ButtonAdv L abel="➕ Add New Student"
                    C ommand="{Binding AddStudentCommand}"
                    S tyle="{StaticResource BusBuddyPrimaryButtonStyle}" Margin="5"
                    T oolTip="Add a new student"/>

            <syncfusion:ButtonAdv L abel="✏️ Edit Student"
                    C ommand="{Binding EditStudentCommand}"
                    S tyle="{StaticResource BusBuddySecondaryButtonStyle}" Margin="5"
                    T oolTip="Edit the selected student"/>

            <syncfusion:ButtonAdv L abel="🚌 Assign Route"
                    C ommand="{Binding AssignRouteCommand}"
                    S tyle="{StaticResource BusBuddySecondaryButtonStyle}" Margin="5"
                    T oolTip="Assign a route to the selected student"/>

            <syncfusion:ButtonAdv L abel="🗑️ Delete"
                    C ommand="{Binding DeleteStudentCommand}"
                    S tyle="{StaticResource BusBuddyDeleteButtonStyle}" Margin="5"
                    T oolTip="Delete the selected student"/>
        </StackPanel>

        <!-- Loading Indicator -->
        <syncfusion:SfBusyIndicator Grid.R ow="0" Grid.R owSpan="5"
                              I sBusy="{Binding IsBusy}"
                              S tyle="{StaticResource BusBuddySfBusyIndicatorStyle}" AnimationType="DoubleCircle"
                              F oreground="{StaticResource AccentBrush}"
                              B ackground="Transparent">
            <syncfusion:SfBusyIndicator.Content>
                <TextBlock T ext="Loading..."
                           F oreground="{StaticResource PrimaryForeground}"
                           F ontSize="16"
                           M argin="0,10,0,0"
                           H orizontalAlignment="Center"/>
            </syncfusion:SfBusyIndicator.Content>
        </syncfusion:SfBusyIndicator>

        <!-- In Development Overlay - Hidden when fully implemented -->
        <Border Grid.R ow="0" Grid.R owSpan="5"
                B ackground="#80000000"
                V isibility="{Binding IsInDevelopment, C onverter={StaticResource BooleanToVisibilityConverter}, F allbackValue=Hidden}">
            <TextBlock T ext="Student Management - In Development"
                       H orizontalAlignment="Center"
                       V erticalAlignment="Center"
                       F ontSize="20"
                       F oreground="{StaticResource PrimaryForeground}"/>
        </Border>
    </Grid>
</UserControl>



