<!--
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                                                                          ║
║                                              🔒 BUSBUDDY SYNCFUSION THEME COMPLIANCE REFERENCE 🔒                                                                    ║
║                                                                                                                                                                          ║
║  📋 REQUIRED STANDARDS: This child form MUST follow the universal standards defined in:                                                                                ║
║     - BusBuddy.WPF\Resources\SyncfusionFluentDarkTheme.xaml (Universal Control Standards)                                                                             ║
║     - Documentation\SyncfusionThemeImplementationGuide.md (Implementation Guide)                                                                                       ║
║                                                                                                                                                                          ║
║  🔧 MANDATORY IMPLEMENTATIONS:                                                                                                                                          ║
║     ✅ UserControl Style: BusBuddyUserControlStyle                                                                                                                     ║
║     ✅ Button Controls: Use syncfusion:ButtonAdv with Label property (NOT Content)                                                                                    ║
║     ✅ Data Grid: Use syncfusion:SfDataGrid with BusBuddySfDataGridStyle                                                                                              ║
║     ✅ Input Controls: Use Syncfusion equivalents (ComboBoxAdv, TextBoxExt, etc.)                                                                                     ║
║     ✅ Theme Application:on ALL Syncfusion controls                                                           ║
║     ✅ Color Palette: Use FluentDark brushes defined in SyncfusionFluentDarkTheme.xaml                                                                                ║
║                                                                                                                                                                          ║
║  ⚠️  CRITICAL REMINDERS:                                                                                                                                               ║
║     • NEVER use standard WPF Button - use syncfusion:ButtonAdv                                                                                                        ║
║     • NEVER use Content property on ButtonAdv - use Label property                                                                                                    ║
║     • NEVER use "sf:" namespace prefix - use "syncfusion:" prefix                                                                                                     ║
║     • ALWAYS apply FluentDark theme to maintain visual consistency                                                                                                     ║
║     • ALWAYS reference baseline styles for consistent appearance                                                                                                       ║
║                                                                                                                                                                          ║
║  📚 DEVELOPMENT REFERENCE: See Documentation\SyncfusionThemeImplementationGuide.md for copy-paste templates                                                          ║
║                                                                                                                                                                          ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
-->

<UserControl x:Class="BusBuddy.WPF.Views.Fuel.FuelManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;a ssembly=Syncfusion.SfSkinManager.WPF"
             xmlns:c hart="clr-namespace:Syncfusion.UI.Xaml.Charts;a ssembly=Syncfusion.SfChart.WPF"
             xmlns:g auge="clr-namespace:Syncfusion.UI.Xaml.Gauges;a ssembly=Syncfusion.SfGauge.WPF"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             mc:I gnorable="d"
             d:D esignHeight="800" d:D esignWidth="1200"
             d:D ataContext="{d:DesignInstance viewModels:FuelManagementViewModel}" Loaded="UserControl_Loaded"
             U nloaded="UserControl_Unloaded">
    <!-- Local resources removed - all converters now global in App.xaml -->

    <!-- Enhanced Fuel Management with Syncfusion DockingManager -->
    <syncfusion:DockingManager U seDocumentContainer="True"
                              P ersistState="False"
                              C ontainerMode="TDI"
                              S tyle="{StaticResource BusBuddyDockingManagerStyle}" Background="{StaticResource ContentBackground}">

        <!-- Fuel Overview Dashboard (Document) -->
        <ContentControl syncfusion:DockingManager.H eader="Fuel Overview"
                       syncfusion:DockingManager.S tate="Document"
                       syncfusion:DockingManager.C anSerialize="True">
            <Grid M argin="20">
                <Grid.RowDefinitions>
                    <RowDefinition H eight="Auto"/>
                    <RowDefinition H eight="Auto"/>
                    <RowDefinition H eight="*"/>
                </Grid.RowDefinitions>

                <!-- Enhanced Header -->
                <DockPanel Grid.R ow="0" M argin="0,0,0,20">
                    <TextBlock T ext="⛽ Fuel Management Dashboard"
                              S tyle="{StaticResource BusBuddyTileHeaderStyle}"
                              DockPanel.D ock="Left"/>
                    <StackPanel O rientation="Horizontal" DockPanel.D ock="Right">
                        <syncfusion:ButtonAdv x:N ame="AddFuelRecordButton"
                                            L abel="➕ New Fuel Record"
                                            C ommand="{Binding AddCommand}"
                                            S tyle="{StaticResource BusBuddyPrimaryButtonStyle}" Margin="5"
                                            C lick="AddFuelRecordButton_Click"/>
                        <syncfusion:ButtonAdv x:N ame="GenerateFuelReportButton"
                                            L abel="📊 Fuel Reports"
                                            C ommand="{Binding ReportCommand}"
                                            S tyle="{StaticResource BusBuddySecondaryButtonStyle}" Margin="5"
                                            C lick="GenerateFuelReportButton_Click"/>
                        <syncfusion:ButtonAdv x:N ame="FuelReconciliationButton"
                                            L abel="🔄 Reconciliation"
                                            C ommand="{Binding ReconciliationCommand}"
                                            S tyle="{StaticResource BusBuddySecondaryButtonStyle}" Margin="5"
                                            C lick="FuelReconciliationButton_Click"/>
                        <syncfusion:ButtonAdv x:N ame="RefreshFuelButton"
                                            L abel="🔄 Refresh"
                                            S tyle="{StaticResource BusBuddySecondaryButtonStyle}" Margin="5"
                                            C lick="RefreshFuelButton_Click"/>
                    </StackPanel>
                </DockPanel>

                <!-- Enhanced Fuel Metrics Dashboard -->
                <UniformGrid Grid.R ow="1" C olumns="4" M argin="0,0,0,20">
                    <!-- Monthly Fuel Cost Tile -->
                    <Border x:N ame="MonthlyFuelCostTile"
                           S tyle="{StaticResource BusBuddyDashboardTileStyle}"
                           M ouseLeftButtonDown="FuelTile_MouseLeftButtonDown">
                        <StackPanel>
                            <DockPanel>
                                <TextBlock T ext="💰 Monthly Cost" F ontSize="14" F ontWeight="SemiBold"
                                          F oreground="{StaticResource SuccessBrush}" DockPanel.D ock="Left"/>
                                <Ellipse W idth="10" H eight="10" F ill="{StaticResource SuccessBrush}" DockPanel.D ock="Right"
                                        V erticalAlignment="Center"/>
                            </DockPanel>
                            <TextBlock T ext="{Binding MonthlyFuelCost, S tringFormat='{}{0:C0}'}"
                                      F ontSize="28" F ontWeight="Bold"
                                      F oreground="{StaticResource SuccessBrush}"
                                      H orizontalAlignment="Center"
                                      M argin="0,10,0,5"/>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition W idth="*"/>
                                    <ColumnDefinition W idth="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.C olumn="0">
                                    <TextBlock T ext="Budget:" F ontSize="10"
                                              F oreground="{StaticResource SecondaryForeground}"/>
                                    <syncfusion:SfLinearProgressBar P rogress="{Binding BudgetUsagePercentage}"
                                                                   H eight="6"
                                                                   B ackground="{StaticResource ContentBackground}"
                                                                   F oreground="{StaticResource SuccessBrush}" Minimum="0" M aximum="100"/>
                                </StackPanel>
                                <TextBlock Grid.C olumn="1" T ext="{Binding BudgetUsagePercentage, S tringFormat='{}{0:F0}%'}"
                                          F ontSize="12" F ontWeight="SemiBold" F oreground="{StaticResource SuccessBrush}"
                                          V erticalAlignment="Center" M argin="8,0,0,0"/>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Average MPG Tile with Gauge -->
                    <Border x:N ame="AverageMPGTile"
                           S tyle="{StaticResource BusBuddyDashboardTileStyle}"
                           M ouseLeftButtonDown="FuelTile_MouseLeftButtonDown">
                        <StackPanel>
                            <DockPanel>
                                <TextBlock T ext="📊 Fleet MPG" F ontSize="14" F ontWeight="SemiBold"
                                          F oreground="{StaticResource InfoBrush}" DockPanel.D ock="Left"/>
                                <Ellipse W idth="10" H eight="10" F ill="{StaticResource InfoBrush}" DockPanel.D ock="Right"
                                        V erticalAlignment="Center"/>
                            </DockPanel>
                            <Grid M argin="0,10,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition W idth="*"/>
                                    <ColumnDefinition W idth="Auto"/>
                                </Grid.ColumnDefinitions>
                                <StackPanel Grid.C olumn="0">
                                    <TextBlock T ext="{Binding AverageFleetMPG, S tringFormat='{}{0:F1} MPG'}"
                                              F ontSize="18" F ontWeight="Bold"
                                              F oreground="{StaticResource InfoBrush}"/>
                                    <TextBlock T ext="Target: 8.5 MPG" F ontSize="10"
                                              F oreground="{StaticResource SecondaryForeground}" M argin="0,5,0,0"/>
                                    <TextBlock T ext="{Binding MPGTrend}" F ontSize="10"
                                              F ontWeight="SemiBold" M argin="0,2,0,0"/>
                                </StackPanel>
                                <gauge:SfCircularGauge Grid.C olumn="1" W idth="60" H eight="60" M argin="5,0,0,0">
                                    <gauge:SfCircularGauge.Scales>
                                        <gauge:CircularScale S tartAngle="135" S weepAngle="270"
                                                           S tartValue="0" E ndValue="15"
                                                           S howTicks="False" S howLabels="False"
                                                           R imStroke="{StaticResource ContentBackground}" R imStrokeThickness="4">
                                            <gauge:CircularScale.Pointers>
                                                <gauge:CircularPointer N eedlePointerType="Triangle"
                                                                     P ointerCapStroke="{StaticResource InfoBrush}"
                                                                     N eedlePointerStroke="{StaticResource InfoBrush}"
                                                                     V alue="{Binding AverageFleetMPG}"/>
                                            </gauge:CircularScale.Pointers>
                                            <gauge:CircularScale.Ranges>
                                                <gauge:CircularRange S tartValue="0" E ndValue="6"
                                                                   S troke="{StaticResource ErrorBrush}" S trokeThickness="4"/>
                                                <gauge:CircularRange S tartValue="6" E ndValue="10"
                                                                   S troke="{StaticResource WarningBrush}" S trokeThickness="4"/>
                                                <gauge:CircularRange S tartValue="10" E ndValue="15"
                                                                   S troke="{StaticResource SuccessBrush}" S trokeThickness="4"/>
                                            </gauge:CircularScale.Ranges>
                                        </gauge:CircularScale>
                                    </gauge:SfCircularGauge.Scales>
                                </gauge:SfCircularGauge>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Total Gallons Consumed Tile -->
                    <Border x:N ame="TotalGallonsTile"
                           S tyle="{StaticResource BusBuddyDashboardTileStyle}"
                           M ouseLeftButtonDown="FuelTile_MouseLeftButtonDown">
                        <StackPanel>
                            <DockPanel>
                                <TextBlock T ext="⛽ Monthly Gallons" F ontSize="14" F ontWeight="SemiBold"
                                          F oreground="{StaticResource WarningBrush}" DockPanel.D ock="Left"/>
                                <Ellipse W idth="10" H eight="10" F ill="{StaticResource WarningBrush}" DockPanel.D ock="Right"
                                        V erticalAlignment="Center"/>
                            </DockPanel>
                            <TextBlock T ext="{Binding MonthlyGallonsConsumed, S tringFormat='{}{0:N0}'}"
                                      F ontSize="28" F ontWeight="Bold"
                                      F oreground="{StaticResource WarningBrush}"
                                      H orizontalAlignment="Center"
                                      M argin="0,10,0,5"/>
                            <StackPanel>
                                <TextBlock T ext="gallons" F ontSize="12"
                                          F oreground="{StaticResource SecondaryForeground}"
                                          H orizontalAlignment="Center"/>
                                <TextBlock T ext="{Binding GallonsVsLastMonth}" F ontSize="10"
                                          F ontWeight="SemiBold"
                                          H orizontalAlignment="Center"
                                          M argin="0,5,0,0"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Cost Per Mile Efficiency Tile -->
                    <Border x:N ame="CostPerMileTile"
                           S tyle="{StaticResource BusBuddyDashboardTileStyle}"
                           M ouseLeftButtonDown="FuelTile_MouseLeftButtonDown">
                        <StackPanel>
                            <DockPanel>
                                <TextBlock T ext="💲 Cost Per Mile" F ontSize="14" F ontWeight="SemiBold"
                                          F oreground="{DynamicResource PrimaryBrush}" DockPanel.D ock="Left"/>
                                <Ellipse W idth="10" H eight="10" F ill="{DynamicResource PrimaryBrush}" DockPanel.D ock="Right"
                                        V erticalAlignment="Center"/>
                            </DockPanel>
                            <TextBlock T ext="{Binding CostPerMile, S tringFormat='{}{0:C2}'}"
                                      F ontSize="24" F ontWeight="Bold"
                                      F oreground="{DynamicResource PrimaryBrush}"
                                      H orizontalAlignment="Center"
                                      M argin="0,10,0,5"/>
                            <StackPanel>
                                <TextBlock T ext="per mile" F ontSize="12"
                                          F oreground="{StaticResource SecondaryForeground}"
                                          H orizontalAlignment="Center"/>
                                <Border B ackground="{DynamicResource PrimaryBrush}" C ornerRadius="3" P adding="6,2"
                                       H orizontalAlignment="Center" M argin="0,8,0,0">
                                    <TextBlock T ext="{Binding EfficiencyRating}"
                                              F oreground="{StaticResource Foreground}" F ontSize="10" F ontWeight="SemiBold"/>
                                </Border>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </UniformGrid>

                <!-- Enhanced Fuel Records Grid -->
                <syncfusion:SfDataGrid x:N ame="FuelDataGrid"
                                      Grid.R ow="2"
                                      I temsSource="{Binding FuelRecords}"
                                      S electedItem="{Binding SelectedFuelRecord, M ode=TwoWay}"
                                      A utoGenerateColumns="False"
                                      A llowResizingColumns="True"
                                      A llowSorting="True"
                                      A llowFiltering="True"
                                      A llowGrouping="True"
                                      S howGroupDropArea="True"
                                      C olumnSizer="Star"
                                      S electionMode="Single"
                                      N avigationMode="Row"
                                      A llowEditing="False"
                                      S howRowHeader="False"
                                      S tyle="{StaticResource BusBuddySfDataGridStyle}" SelectionChanged="FuelDataGrid_SelectionChanged"
                                      C ellTapped="FuelDataGrid_CellTapped"
                                      B orderThickness="1"
                                      B orderBrush="{StaticResource BorderBrush}">
                    <syncfusion:SfDataGrid.Columns>
                        <!-- Enhanced Date Column -->
                        <syncfusion:GridDateTimeColumn M appingName="FuelDate" H eaderText="Date" W idth="100"
                                                      P attern="ShortDate"/>

                        <!-- Enhanced Bus Column with Visual Indicator -->
                        <syncfusion:GridTemplateColumn M appingName="BusNumber" H eaderText="Bus" W idth="80">
                            <syncfusion:GridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border B ackground="{StaticResource InfoBrush}" C ornerRadius="4" P adding="4,2" M argin="1">
                                        <StackPanel O rientation="Horizontal">
                                            <TextBlock T ext="🚌" F ontSize="10" V erticalAlignment="Center" M argin="0,0,3,0"/>
                                            <TextBlock T ext="{Binding BusNumber}"
                                                      F ontWeight="SemiBold" F ontSize="10"
                                                      F oreground="{StaticResource InfoBrush}" V erticalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                </DataTemplate>
                            </syncfusion:GridTemplateColumn.CellTemplate>
                        </syncfusion:GridTemplateColumn>

                        <!-- Fuel Location -->
                        <syncfusion:GridTextColumn M appingName="FuelLocation" H eaderText="Location" W idth="120"/>

                        <!-- Odometer Reading -->
                        <syncfusion:GridNumericColumn M appingName="VehicleOdometerReading" H eaderText="Odometer" W idth="100"
                                                     N umberGroupSeparator=","/>

                        <!-- Fuel Type with Icon -->
                        <syncfusion:GridTemplateColumn M appingName="FuelType" H eaderText="Fuel Type" W idth="100">
                            <syncfusion:GridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <StackPanel O rientation="Horizontal">
                                        <TextBlock T ext="⛽" F ontSize="10" V erticalAlignment="Center" M argin="0,0,3,0"/>
                                        <TextBlock T ext="{Binding FuelType}" F ontSize="10" V erticalAlignment="Center"
                                                  F oreground="{StaticResource Foreground}"/>
                                    </StackPanel>
                                </DataTemplate>
                            </syncfusion:GridTemplateColumn.CellTemplate>
                        </syncfusion:GridTemplateColumn>

                        <!-- Gallons with Formatting -->
                        <syncfusion:GridNumericColumn M appingName="Gallons" H eaderText="Gallons" W idth="90"
                                                     N umberDecimalDigits="2"/>

                        <!-- Price Per Gallon -->
                        <syncfusion:GridCurrencyColumn M appingName="PricePerGallon" H eaderText="Price/Gal" W idth="100"/>

                        <!-- Total Cost -->
                        <syncfusion:GridCurrencyColumn M appingName="TotalCost" H eaderText="Total Cost" W idth="100"/>

                        <!-- MPG Calculation (if available) -->
                        <syncfusion:GridTemplateColumn M appingName="MPG" H eaderText="MPG" W idth="80">
                            <syncfusion:GridTemplateColumn.CellTemplate>
                                <DataTemplate>
                                    <Border B ackground="{StaticResource SuccessBrush}" C ornerRadius="3" P adding="4,2" M argin="1">
                                        <TextBlock T ext="{Binding MPG, S tringFormat='{}{0:F1}'}"
                                                  F ontSize="10" F ontWeight="SemiBold"
                                                  F oreground="{StaticResource SuccessBrush}" H orizontalAlignment="Center"/>
                                    </Border>
                                </DataTemplate>
                            </syncfusion:GridTemplateColumn.CellTemplate>
                        </syncfusion:GridTemplateColumn>

                        <!-- Driver (if tracked) -->
                        <syncfusion:GridTextColumn M appingName="DriverName" H eaderText="Driver" W idth="120"/>

                        <!-- Notes -->
                        <syncfusion:GridTextColumn M appingName="Notes" H eaderText="Notes" W idth="150"
                                                  T extWrapping="Wrap"/>
                    </syncfusion:SfDataGrid.Columns>

                    <!-- Context Menu -->
                    <syncfusion:SfDataGrid.ContextMenu>
                        <ContextMenu S tyle="{StaticResource BusBuddyContextMenuStyle}">
                            <MenuItem H eader="📝 Edit Fuel Record" C ommand="{Binding EditCommand}"
                                     S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                            <MenuItem H eader="📋 Duplicate Record" C ommand="{Binding DuplicateCommand}"
                                     S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                            <Separator S tyle="{StaticResource BusBuddyContextMenuSeparatorStyle}"/>
                            <MenuItem H eader="📊 MPG Analysis" C ommand="{Binding AnalyzeMPGCommand}"
                                     S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                            <MenuItem H eader="💰 Cost Analysis" C ommand="{Binding AnalyzeCostCommand}"
                                     S tyle="{StaticResource BusBuddyContextMenuItemStyle}"/>
                            <Separator S tyle="{StaticResource BusBuddyContextMenuSeparatorStyle}"/>
                            <MenuItem H eader="🗑️ Delete" C ommand="{Binding DeleteCommand}"
                                     S tyle="{StaticResource BusBuddyContextMenuItemStyle}"
                                     F oreground="{StaticResource ErrorBrush}"/>
                        </ContextMenu>
                    </syncfusion:SfDataGrid.ContextMenu>
                </syncfusion:SfDataGrid>
            </Grid>
        </ContentControl>

        <!-- Fuel Analytics Charts (Docked Right) -->
        <ContentControl syncfusion:DockingManager.H eader="Fuel Analytics"
                       syncfusion:DockingManager.S tate="Dock"
                       syncfusion:DockingManager.S ideInDockedMode="Right"
                       syncfusion:DockingManager.D esiredWidthInDockedMode="400"
                       syncfusion:DockingManager.C anSerialize="True">
            <ScrollViewer V erticalScrollBarVisibility="Auto" M argin="15">
                <StackPanel>
                    <TextBlock T ext="📈 Fuel Analytics" F ontSize="16" F ontWeight="Bold" M argin="0,0,0,20"/>

                    <!-- MPG Trends Chart -->
                    <Border B orderBrush="{StaticResource BorderBrush}" B orderThickness="1" C ornerRadius="6" M argin="0,0,0,20">
                        <StackPanel M argin="15">
                            <TextBlock T ext="MPG Trends" F ontWeight="SemiBold" F ontSize="14" M argin="0,0,0,10"
                                      F oreground="{StaticResource Foreground}"/>
                            <chart:SfChart x:N ame="MPGTrendsChart"
                                          H eight="200" Background="Transparent"
                                          M ouseLeftButtonDown="Chart_MouseLeftButtonDown">
                                <chart:SfChart.PrimaryAxis>
                                    <chart:DateTimeAxis S howGridLines="False"
                                                       L abelFormat="MMM"
                                                       I ntervalType="Months">
                                                       <chart:DateTimeAxis.LabelStyle>
                                                           <chart:LabelStyle F oreground="{StaticResource SecondaryForeground}"/>
                                                       </chart:DateTimeAxis.LabelStyle>
                                    </chart:DateTimeAxis>
                                </chart:SfChart.PrimaryAxis>
                                <chart:SfChart.SecondaryAxis>
                                    <chart:NumericalAxis S howGridLines="True"
                                                        H eader="Miles Per Gallon">
                                                        <chart:NumericalAxis.HeaderStyle>
                                                            <chart:LabelStyle F oreground="{StaticResource Foreground}"/>
                                                        </chart:NumericalAxis.HeaderStyle>
                                                        <chart:NumericalAxis.LabelStyle>
                                                            <chart:LabelStyle F oreground="{StaticResource SecondaryForeground}"/>
                                                        </chart:NumericalAxis.LabelStyle>
                                    </chart:NumericalAxis>
                                </chart:SfChart.SecondaryAxis>
                                <chart:SfChart.Series>
                                    <chart:SplineAreaSeries I temsSource="{Binding MPGTrendsData}"
                                                          X BindingPath="Period"
                                                          Y BindingPath="AverageMPG"
                                                          S trokeThickness="3"
                                                          S troke="{StaticResource InfoBrush}">
                                        <chart:SplineAreaSeries.Interior>
                                            <LinearGradientBrush S tartPoint="0,0" E ndPoint="0,1">
                                                <GradientStop C olor="{StaticResource InfoBrush}" O ffset="0"/>
                                                <GradientStop C olor="{StaticResource InfoBrush}" O ffset="1"/>
                                            </LinearGradientBrush>
                                        </chart:SplineAreaSeries.Interior>
                                    </chart:SplineAreaSeries>
                                </chart:SfChart.Series>
                            </chart:SfChart>
                        </StackPanel>
                    </Border>

                    <!-- Cost Analysis Chart -->
                    <Border B orderBrush="{StaticResource BorderBrush}" B orderThickness="1" C ornerRadius="6" M argin="0,0,0,20">
                        <StackPanel M argin="15">
                            <TextBlock T ext="Monthly Cost Analysis" F ontWeight="SemiBold" F ontSize="14" M argin="0,0,0,10"
                                      F oreground="{StaticResource Foreground}"/>
                            <chart:SfChart x:N ame="CostAnalysisChart"
                                          H eight="200" Background="Transparent"
                                          M ouseLeftButtonDown="Chart_MouseLeftButtonDown">
                                <chart:SfChart.PrimaryAxis>
                                    <chart:CategoryAxis S howGridLines="False">
                                        <chart:CategoryAxis.LabelStyle>
                                            <Style T argetType=" Label">
                                                <Setter P roperty=" Foreground" V alue="{StaticResource SecondaryForeground}"/>
                                            </Style>
                                        </chart:CategoryAxis.LabelStyle>
                                    </chart:CategoryAxis>
                                </chart:SfChart.PrimaryAxis>
                                <chart:SfChart.SecondaryAxis>
                                    <chart:NumericalAxis S howGridLines="True"
                                                        H eader="Cost ($)">
                                        <chart:NumericalAxis.HeaderStyle>
                                            <Style T argetType=" Label">
                                                <Setter P roperty=" Foreground" V alue="{StaticResource Foreground}"/>
                                            </Style>
                                        </chart:NumericalAxis.HeaderStyle>
                                        <chart:NumericalAxis.LabelStyle>
                                            <Style T argetType=" Label">
                                                <Setter P roperty=" Foreground" V alue="{StaticResource SecondaryForeground}"/>
                                            </Style>
                                        </chart:NumericalAxis.LabelStyle>
                                    </chart:NumericalAxis>
                                </chart:SfChart.SecondaryAxis>
                                <chart:SfChart.Series>
                                    <chart:ColumnSeries I temsSource="{Binding MonthlyCostData}"
                                                       X BindingPath="Month"
                                                       Y BindingPath="TotalCost">
                                        <chart:ColumnSeries.Interior>
                                            <LinearGradientBrush S tartPoint="0,0" E ndPoint="0,1">
                                                <GradientStop C olor="{StaticResource SuccessBrush}" O ffset="0"/>
                                                <GradientStop C olor="{StaticResource SuccessBrush}" O ffset="1"/>
                                            </LinearGradientBrush>
                                        </chart:ColumnSeries.Interior>
                                    </chart:ColumnSeries>
                                </chart:SfChart.Series>
                            </chart:SfChart>
                        </StackPanel>
                    </Border>

                    <!-- Fuel Efficiency Distribution -->
                    <Border B orderBrush="{StaticResource BorderBrush}" B orderThickness="1" C ornerRadius="6" M argin="0,0,0,20">
                        <StackPanel M argin="15">
                            <TextBlock T ext="Fleet Efficiency Distribution" F ontWeight="SemiBold" F ontSize="14" M argin="0,0,0,10"
                                      F oreground="{StaticResource Foreground}"/>
                            <chart:SfChart x:N ame="EfficiencyDistributionChart"
                                          H eight="180" Background="Transparent"
                                          M ouseLeftButtonDown="Chart_MouseLeftButtonDown">
                                <chart:PieSeries I temsSource="{Binding EfficiencyDistributionData}"
                                               X BindingPath="EfficiencyCategory"
                                               Y BindingPath="BusCount"
                                               E xplodeIndex="0"
                                               P alette="FluentDark"
                                               E xplodeRadius="8"/>
                            </chart:SfChart>
                        </StackPanel>
                    </Border>

                    <!-- Performance Summary -->
                    <Border B orderBrush="{StaticResource BorderBrush}" B orderThickness="1" C ornerRadius="6">
                        <StackPanel M argin="15">
                            <TextBlock T ext="Performance Summary" F ontWeight="SemiBold" F ontSize="14" M argin="0,0,0,15"
                                      F oreground="{StaticResource Foreground}"/>

                            <!-- Best Performing Bus -->
                            <DockPanel M argin="0,0,0,8">
                                <TextBlock T ext="🏆 Best MPG:" DockPanel.D ock="Left" F ontSize="12"
                                          F oreground="{StaticResource Foreground}"/>
                                <TextBlock T ext="{Binding BestPerformingBus}" DockPanel.D ock="Right"
                                          F ontWeight="SemiBold" F ontSize="12" F oreground="{StaticResource SuccessBrush}"/>
                            </DockPanel>

                            <!-- Most Efficient Route -->
                            <DockPanel M argin="0,0,0,8">
                                <TextBlock T ext="🛣️ Most Efficient Route:" DockPanel.D ock="Left" F ontSize="12"
                                          F oreground="{StaticResource Foreground}"/>
                                <TextBlock T ext="{Binding MostEfficientRoute}" DockPanel.D ock="Right"
                                          F ontWeight="SemiBold" F ontSize="12" F oreground="{StaticResource InfoBrush}"/>
                            </DockPanel>

                            <!-- Potential Savings -->
                            <DockPanel M argin="0,0,0,15">
                                <TextBlock T ext="💡 Potential Savings:" DockPanel.D ock="Left" F ontSize="12"
                                          F oreground="{StaticResource Foreground}"/>
                                <TextBlock T ext="{Binding PotentialSavings, S tringFormat='{}{0:C0}/month'}" DockPanel.D ock="Right"
                                          F ontWeight="SemiBold" F ontSize="12" F oreground="{StaticResource WarningBrush}"/>
                            </DockPanel>

                            <!-- Efficiency Score Gauge -->
                            <TextBlock T ext="Fleet Efficiency Score:" F ontSize="12" M argin="0,0,0,5"
                                      F oreground="{StaticResource Foreground}"/>
                            <gauge:SfCircularGauge W idth="120" H eight="120" H orizontalAlignment="Center">
                                <gauge:SfCircularGauge.Scales>
                                    <gauge:CircularScale S tartAngle="135" S weepAngle="270"
                                                       S tartValue="0" E ndValue="100"
                                                       I nterval="20" M inorTicksPerInterval="1"
                                                       R imStroke="{StaticResource ContentBackground}" R imStrokeThickness="10"
                                                       T ickStroke="{StaticResource SecondaryForeground}" T ickStrokeThickness="1"
                                                       L abelStroke="{StaticResource Foreground}">
                                        <gauge:CircularScale.Pointers>
                                            <gauge:CircularPointer N eedlePointerType="Triangle"
                                                                 P ointerCapStroke="{StaticResource SuccessBrush}"
                                                                 N eedlePointerStroke="{StaticResource SuccessBrush}"
                                                                 V alue="{Binding FleetEfficiencyScore}"/>
                                        </gauge:CircularScale.Pointers>
                                        <gauge:CircularScale.Ranges>
                                            <gauge:CircularRange S tartValue="0" E ndValue="40"
                                                               S troke="{StaticResource ErrorBrush}" S trokeThickness="10"/>
                                            <gauge:CircularRange S tartValue="40" E ndValue="70"
                                                               S troke="{StaticResource WarningBrush}" S trokeThickness="10"/>
                                            <gauge:CircularRange S tartValue="70" E ndValue="100"
                                                               S troke="{StaticResource SuccessBrush}" S trokeThickness="10"/>
                                        </gauge:CircularScale.Ranges>
                                    </gauge:CircularScale>
                                </gauge:SfCircularGauge.Scales>
                                <gauge:SfCircularGauge.Annotations>
                                    <gauge:GaugeAnnotation>
                                        <gauge:GaugeAnnotation.Content>
                                            <StackPanel H orizontalAlignment="Center">
                                                <TextBlock T ext="{Binding FleetEfficiencyScore, S tringFormat='{}{0:F0}%'}"
                                                          F ontSize="16" F ontWeight="Bold"
                                                          F oreground="{StaticResource SuccessBrush}" H orizontalAlignment="Center"/>
                                                <TextBlock T ext="Efficiency" F ontSize="10"
                                                          F oreground="{StaticResource SecondaryForeground}" H orizontalAlignment="Center"/>
                                            </StackPanel>
                                        </gauge:GaugeAnnotation.Content>
                                    </gauge:GaugeAnnotation>
                                </gauge:SfCircularGauge.Annotations>
                            </gauge:SfCircularGauge>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </ContentControl>

        <!-- Loading Indicator -->
        <Border syncfusion:DockingManager.C anSerialize="False"
                B ackground="{StaticResource OverlayBrush}"
                V isibility="{Binding IsBusy, C onverter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel V erticalAlignment="Center" H orizontalAlignment="Center">
                <syncfusion:SfBusyIndicator I sBusy="True"
                                           A nimationType="DoubleCircle"
                                           F oreground="{StaticResource Foreground}"
                                           S tyle="{StaticResource BusBuddySfBusyIndicatorStyle}" Height="60"
                                           W idth="60"/>
                <TextBlock T ext="Loading fuel data..."
                           F oreground="{StaticResource Foreground}"
                           F ontSize="16"
                           M argin="0,15,0,0"
                           H orizontalAlignment="Center"/>
            </StackPanel>
        </Border>
    </syncfusion:DockingManager>
</UserControl>

