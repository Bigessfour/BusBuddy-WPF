<!--
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                                                                          ║
║                                              🔒 BUSBUDDY SYNCFUSION THEME COMPLIANCE REFERENCE 🔒                                                                    ║
║                                                                                                                                                                          ║
║  📋 REQUIRED STANDARDS: This child form MUST follow the universal standards defined in:                                                                                ║
║     - BusBuddy.WPF\Resources\SyncfusionFluentDarkTheme.xaml (Universal Control Standards)                                                                             ║
║     - Documentation\SyncfusionThemeImplementationGuide.md (Implementation Guide)                                                                                       ║
║                                                                                                                                                                          ║
║  🔧 MANDATORY IMPLEMENTATIONS:                                                                                                                                          ║
║     ✅ UserControl Style: BusBuddyUserControlStyle                                                                                                                     ║
║     ✅ Button Controls: Use syncfusion:ButtonAdv with Label property (NOT Content)                                                                                    ║
║     ✅ Data Grid: Use syncfusion:SfDataGrid with BusBuddySfDataGridStyle                                                                                              ║
║     ✅ Input Controls: Use Syncfusion equivalents (ComboBoxAdv, TextBoxExt, etc.)                                                                                     ║
║     ✅ Theme Application:on ALL Syncfusion controls                                                           ║
║     ✅ Color Palette: Use FluentDark brushes defined in SyncfusionFluentDarkTheme.xaml                                                                                ║
║                                                                                                                                                                          ║
║  ⚠️  CRITICAL REMINDERS:                                                                                                                                               ║
║     • NEVER use standard WPF Button - use syncfusion:ButtonAdv                                                                                                        ║
║     • NEVER use Content property on ButtonAdv - use Label property                                                                                                    ║
║     • NEVER use "sf:" namespace prefix - use "syncfusion:" prefix                                                                                                     ║
║     • ALWAYS apply FluentDark theme to maintain visual consistency                                                                                                     ║
║     • ALWAYS reference baseline styles for consistent appearance                                                                                                       ║
║                                                                                                                                                                          ║
║  📚 DEVELOPMENT REFERENCE: See Documentation\SyncfusionThemeImplementationGuide.md for copy-paste templates                                                          ║
║                                                                                                                                                                          ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
-->

<UserControl x:Class="BusBuddy.WPF.Views.Driver.DriverManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;a ssembly=Syncfusion.SfSkinManager.WPF"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             mc:I gnorable="d"
             d:D esignHeight="600" d:D esignWidth="800"
             d:D ataContext="{d:DesignInstance viewModels:DriverManagementViewModel}">

    <UserControl.Resources>
        <!-- BooleanToVisibilityConverter is now global in App.xaml -->

        <!-- License Status Color Converter for highlighting expiring licenses -->
        <DataTemplate x:K ey="LicenseStatusTemplate">
            <Border B ackground="{Binding LicenseStatus, C onverter={StaticResource LicenseStatusToColorConverter}}"
                    C ornerRadius="4" P adding="8,4">
                <TextBlock T ext="{Binding LicenseStatus}"
                          F oreground="White"
                          F ontWeight="SemiBold"
                          H orizontalAlignment="Center"/>
            </Border>
        </DataTemplate>
    </UserControl.Resources>

    <!-- Enhanced Driver Management with Syncfusion DockingManager -->
    <syncfusion:DockingManager U seDocumentContainer="True"
                               P ersistState="False"
                               C ontainerMode="TDI"
                               S tyle="{StaticResource BusBuddyDockingManagerStyle}">

        <!-- Main Driver List Panel (Document) -->
        <ContentControl syncfusion:DockingManager.H eader="Driver Directory"
                       syncfusion:DockingManager.S tate="Document"
                       syncfusion:DockingManager.C anSerialize="True">
            <Grid M argin="20">
                <Grid.RowDefinitions>
                    <RowDefinition H eight="Auto"/>
                    <RowDefinition H eight="*"/>
                    <RowDefinition H eight="Auto"/>
                </Grid.RowDefinitions>

                <!-- Enhanced Header with Search and Filters -->
                <Grid Grid.R ow="0" M argin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition W idth="*"/>
                        <ColumnDefinition W idth="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.C olumn="0">
                        <TextBlock T ext="🚗 Driver Management"
                                   S tyle="{StaticResource BusBuddyTileHeaderStyle}"
                                   M argin="0,0,0,10"/>

                        <!-- Search and Filter Panel -->
                        <Border B ackground="{DynamicResource SurfaceBackground}"
                                B orderBrush="{DynamicResource SurfaceBorderBrush}"
                                B orderThickness="1"
                                C ornerRadius="4"
                                P adding="12">
                            <StackPanel O rientation="Horizontal">
                                <syncfusion:SfTextBoxExt x:N ame="SearchBox"
                                                      T ext="{Binding SearchText, U pdateSourceTrigger=PropertyChanged}" Width="250"
                                                      H eight="32"
                                                      M argin="0,0,10,0"/>
                                <syncfusion:ButtonAdv L abel="🔍 Search"
                                                     C ommand="{Binding SearchDriversCommand}"
                                                     C ommandParameter="{Binding Text, E lementName=SearchBox}"
                                                     S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" Margin="0,0,10,0"/>
                                <syncfusion:ComboBoxAdv I temsSource="{Binding AvailableStatuses}"
                                                       S electedItem="{Binding SelectedStatusFilter}"
                                                       D isplayMemberPath="Name"
                                                       S tyle="{StaticResource BusBuddyComboBoxAdvStyle}" Width="150" H eight="32"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Quick Stats Panel -->
                    <StackPanel Grid.C olumn="1" O rientation="Horizontal">
                        <Border S tyle="{StaticResource BusBuddyDashboardTileStyle}" M argin="5,0">
                            <StackPanel>
                                <TextBlock T ext="Total Drivers"
                                           S tyle="{StaticResource BusBuddyTileContentStyle}"/>
                                <TextBlock T ext="{Binding TotalDrivers}"
                                           S tyle="{StaticResource BusBuddyTileValueStyle}"/>
                            </StackPanel>
                        </Border>
                        <Border S tyle="{StaticResource BusBuddyDashboardTileStyle}" M argin="5,0">
                            <StackPanel>
                                <TextBlock T ext="License Expiring"
                                           S tyle="{StaticResource BusBuddyTileContentStyle}"/>
                                <TextBlock T ext="{Binding LicenseExpiringCount}"
                                           S tyle="{StaticResource BusBuddyTileValueStyle}"
                                           F oreground="{StaticResource WarningBrush}"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Enhanced Data Grid with Conditional Formatting -->
                <syncfusion:SfDataGrid x:N ame="driversGrid" Grid.R ow="1"
                               I temsSource="{Binding Drivers}"
                               S electedItem="{Binding SelectedDriver, M ode=TwoWay}"
                               S tyle="{StaticResource BusBuddySfDataGridStyle}" AutoGenerateColumns="False"
                               A llowResizingColumns="True"
                               A llowSorting="True"
                               A llowFiltering="True"
                               C olumnSizer="Star"
                               S electionMode="Single"
                               S electionUnit="Row"
                               N avigationMode="Row"
                               A llowEditing="False"
                               S howRowHeader="True"
                               E nableDataVirtualization="True"
                               H orizontalAlignment="Stretch"
                               V erticalAlignment="Stretch"
                               R owHeight="40"
                               H eaderRowHeight="45">

                    <syncfusion:SfDataGrid.Columns>
                        <syncfusion:GridTextColumn M appingName="FirstName" H eaderText="First Name" W idth="120"/>
                        <syncfusion:GridTextColumn M appingName="LastName" H eaderText="Last Name" W idth="120"/>
                        <syncfusion:GridTextColumn M appingName="ContactPhone" H eaderText="Phone" W idth="130"/>
                        <syncfusion:GridTextColumn M appingName="ContactEmail" H eaderText="Email" W idth="200"/>
                        <syncfusion:GridDateTimeColumn M appingName="HireDate" H eaderText="Hire Date" W idth="120" P attern="ShortDate"/>
                        <syncfusion:GridDateTimeColumn M appingName="LicenseExpiryDate" H eaderText="License Expiry" W idth="140" P attern="ShortDate"/>
                        <syncfusion:GridTextColumn M appingName="Status" H eaderText="Status" W idth="100"/>
                        <syncfusion:GridTextColumn M appingName="AvailableHours" H eaderText="Available Hours" W idth="120"/>
                    </syncfusion:SfDataGrid.Columns>

                    <!-- Context Menu for Right-Click Actions -->
                    <syncfusion:SfDataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem H eader="View Details" C ommand="{Binding ViewDriverDetailsCommand}"/>
                            <MenuItem H eader="Edit Driver" C ommand="{Binding EditDriverCommand}"/>
                            <Separator/>
                            <MenuItem H eader="Schedule Assignment" C ommand="{Binding ScheduleAssignmentCommand}"/>
                            <MenuItem H eader="Generate Report" C ommand="{Binding GenerateDriverReportCommand}"/>
                            <Separator/>
                            <MenuItem H eader="Delete Driver" C ommand="{Binding DeleteDriverCommand}"
                                     F oreground="{StaticResource ErrorBrush}"/>
                        </ContextMenu>
                    </syncfusion:SfDataGrid.ContextMenu>
                </syncfusion:SfDataGrid>

                <!-- Enhanced Action Panel with Syncfusion Buttons -->
                <Grid Grid.R ow="2" M argin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition W idth="*"/>
                        <ColumnDefinition W idth="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Driver Status Summary -->
                    <StackPanel Grid.C olumn="0" O rientation="Horizontal" V erticalAlignment="Center">
                        <TextBlock T ext="Showing"
                                   V erticalAlignment="Center"
                                   M argin="0,0,5,0"
                                   F oreground="{DynamicResource SecondaryForeground}"/>
                        <TextBlock T ext="{Binding Drivers.Count, M ode=OneWay}"
                                   F ontWeight="SemiBold"
                                   V erticalAlignment="Center"
                                   F oreground="{DynamicResource ContentForeground}"/>
                        <TextBlock T ext="of"
                                   V erticalAlignment="Center"
                                   M argin="5,0"
                                   F oreground="{DynamicResource SecondaryForeground}"/>
                        <TextBlock T ext="{Binding TotalDrivers, M ode=OneWay}"
                                   F ontWeight="SemiBold"
                                   V erticalAlignment="Center"
                                   F oreground="{DynamicResource ContentForeground}"/>
                        <TextBlock T ext="drivers"
                                   V erticalAlignment="Center"
                                   M argin="5,0,15,0"
                                   F oreground="{DynamicResource SecondaryForeground}"/>

                        <!-- License Alert Indicator -->
                        <Border B ackground="{DynamicResource WarningBackground}"
                                C ornerRadius="4"
                                P adding="8,4"
                                V isibility="{Binding HasExpiringLicenses, C onverter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel O rientation="Horizontal">
                                <TextBlock T ext="⚠️" V erticalAlignment="Center" M argin="0,0,5,0"/>
                                <TextBlock T ext="{Binding LicenseExpiringCount, S tringFormat='{}{0} licenses expiring soon'}"
                                          F oreground="White"
                                          F ontWeight="SemiBold"
                                          V erticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.C olumn="1" O rientation="Horizontal">
                        <syncfusion:ButtonAdv L abel="➕ Add Driver"
                                             C ommand="{Binding AddDriverCommand}"
                                             S tyle="{StaticResource BusBuddyPrimaryButtonAdvStyle}" Margin="5"/>
                        <syncfusion:ButtonAdv L abel="✏️ Edit"
                                             C ommand="{Binding UpdateDriverCommand}"
                                             C ommandParameter="{Binding SelectedDriver}"
                                             S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" Margin="5"/>
                        <syncfusion:ButtonAdv L abel="🗑️ Delete"
                                             C ommand="{Binding DeleteDriverCommand}"
                                             C ommandParameter="{Binding SelectedDriver}"
                                             S tyle="{StaticResource BusBuddyButtonAdvStyle}" Margin="5"/>
                        <syncfusion:ButtonAdv L abel="📊 Reports"
                                             C ommand="{Binding GenerateReportsCommand}"
                                             S tyle="{StaticResource BusBuddySecondaryButtonAdvStyle}" Margin="5"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </ContentControl>

        <!-- Loading Indicator -->
        <syncfusion:SfBusyIndicator Grid.R owSpan="3"
                                    I sBusy="{Binding IsLoading}"
                                    S tyle="{StaticResource BusBuddySfBusyIndicatorStyle}" AnimationType="DoubleCircle"
                                    B ackground="Transparent"/>

    </syncfusion:DockingManager>
</UserControl>


