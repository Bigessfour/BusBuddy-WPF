<!--
╔══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║                                                                                                                                                                          ║
║                                              🔒 BUSBUDDY SYNCFUSION THEME COMPLIANCE REFERENCE 🔒                                                                    ║
║                                                                                                                                                                          ║
║  📋 REQUIRED STANDARDS: This child form MUST follow the universal standards defined in:                                                                                ║
║     - BusBuddy.WPF\Resources\SyncfusionFluentDarkTheme.xaml (Universal Control Standards)                                                                             ║
║     - Documentation\SyncfusionThemeImplementationGuide.md (Implementation Guide)                                                                                       ║
║                                                                                                                                                                          ║
║  🔧 MANDATORY IMPLEMENTATIONS:                                                                                                                                          ║
║     ✅ UserControl Style: BusBuddyUserControlStyle                                                                                                                     ║
║     ✅ Button Controls: Use syncfusion:ButtonAdv with Label property (NOT Content)                                                                                    ║
║     ✅ Data Grid: Use syncfusion:SfDataGrid with BusBuddySfDataGridStyle                                                                                              ║
║     ✅ Input Controls: Use Syncfusion equivalents (ComboBoxAdv, TextBoxExt, etc.)                                                                                     ║
║     ✅ Theme Application: syncfusionskin:SfSkinManager.VisualStyle="FluentDark" on ALL Syncfusion controls                                                           ║
║     ✅ Color Palette: Use FluentDark brushes defined in SyncfusionFluentDarkTheme.xaml                                                                                ║
║                                                                                                                                                                          ║
║  ⚠️  CRITICAL REMINDERS:                                                                                                                                               ║
║     • NEVER use standard WPF Button - use syncfusion:ButtonAdv                                                                                                        ║
║     • NEVER use Content property on ButtonAdv - use Label property                                                                                                    ║
║     • NEVER use "sf:" namespace prefix - use "syncfusion:" prefix                                                                                                     ║
║     • ALWAYS apply FluentDark theme to maintain visual consistency                                                                                                     ║
║     • ALWAYS reference baseline styles for consistent appearance                                                                                                       ║
║                                                                                                                                                                          ║
║  📚 DEVELOPMENT REFERENCE: See Documentation\SyncfusionThemeImplementationGuide.md for copy-paste templates                                                          ║
║                                                                                                                                                                          ║
╚══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝
-->

<UserControl x:Class="BusBuddy.WPF.Views.Driver.DriverManagementView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800"
             d:DataContext="{d:DesignInstance viewModels:DriverManagementViewModel}"
             syncfusionskin:SfSkinManager.VisualStyle="FluentDark">

    <UserControl.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

        <!-- License Status Color Converter for highlighting expiring licenses -->
        <DataTemplate x:Key="LicenseStatusTemplate">
            <Border Background="{Binding LicenseStatus, Converter={StaticResource LicenseStatusToColorConverter}}"
                    CornerRadius="4" Padding="8,4">
                <TextBlock Text="{Binding LicenseStatus}"
                          Foreground="White"
                          FontWeight="SemiBold"
                          HorizontalAlignment="Center"/>
            </Border>
        </DataTemplate>
    </UserControl.Resources>

    <!-- Enhanced Driver Management with Syncfusion DockingManager -->
    <syncfusion:DockingManager UseDocumentContainer="True"
                               PersistState="False"
                               ContainerMode="TDI"
                               Style="{StaticResource BusBuddyDockingManagerStyle}"
                               syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                               Background="{StaticResource FluentDarkBackgroundBrush}">

        <!-- Main Driver List Panel (Document) -->
        <ContentControl syncfusion:DockingManager.Header="Driver Directory"
                       syncfusion:DockingManager.State="Document"
                       syncfusion:DockingManager.CanSerialize="True">
            <Grid Margin="20">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Enhanced Header with Search and Filters -->
                <Grid Grid.Row="0" Margin="0,0,0,15">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0">
                        <TextBlock Text="🚗 Driver Management"
                                   Style="{StaticResource BusBuddyTileHeaderStyle}"
                                   Margin="0,0,0,10"/>

                        <!-- Search and Filter Panel -->
                        <Border Background="{StaticResource FluentDarkSurfaceBrush}"
                                BorderBrush="{StaticResource FluentDarkBorderBrush}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="12">
                            <StackPanel Orientation="Horizontal">
                                <syncfusion:SfTextBoxExt x:Name="SearchBox"
                                                      Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"
                                                      syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                                      Background="{StaticResource FluentDarkSurfaceBrush}"
                                                      Foreground="{StaticResource FluentDarkPrimaryTextBrush}"
                                                      BorderBrush="{StaticResource FluentDarkBorderBrush}"
                                                      Width="250"
                                                      Height="32"
                                                      Margin="0,0,10,0"/>
                                <syncfusion:ButtonAdv Label="🔍 Search"
                                                     Command="{Binding SearchDriversCommand}"
                                                     CommandParameter="{Binding Text, ElementName=SearchBox}"
                                                     Style="{StaticResource BusBuddySecondaryButtonStyle}"
                                                     syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                                     Margin="0,0,10,0"/>
                                <syncfusion:ComboBoxAdv ItemsSource="{Binding AvailableStatuses}"
                                                       SelectedItem="{Binding SelectedStatusFilter}"
                                                       DisplayMemberPath="Name"
                                                       Style="{StaticResource BusBuddyComboBoxAdvStyle}"
                                                       syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                                       Background="{StaticResource FluentDarkSurfaceBrush}"
                                                       Foreground="{StaticResource FluentDarkPrimaryTextBrush}"
                                                       BorderBrush="{StaticResource FluentDarkBorderBrush}"
                                                       Width="150" Height="32"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Quick Stats Panel -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <Border Style="{StaticResource BusBuddyDashboardTileStyle}" Margin="5,0">
                            <StackPanel>
                                <TextBlock Text="Total Drivers"
                                           Style="{StaticResource BusBuddyTileContentStyle}"/>
                                <TextBlock Text="{Binding TotalDrivers}"
                                           Style="{StaticResource BusBuddyTileValueStyle}"/>
                            </StackPanel>
                        </Border>
                        <Border Style="{StaticResource BusBuddyDashboardTileStyle}" Margin="5,0">
                            <StackPanel>
                                <TextBlock Text="License Expiring"
                                           Style="{StaticResource BusBuddyTileContentStyle}"/>
                                <TextBlock Text="{Binding LicenseExpiringCount}"
                                           Style="{StaticResource BusBuddyTileValueStyle}"
                                           Foreground="{StaticResource FluentDarkWarningBrush}"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>

                <!-- Enhanced Data Grid with Conditional Formatting -->
                <syncfusion:SfDataGrid x:Name="driversGrid" Grid.Row="1"
                               ItemsSource="{Binding Drivers}"
                               SelectedItem="{Binding SelectedDriver, Mode=TwoWay}"
                               Style="{StaticResource BusBuddySfDataGridStyle}"
                               syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                               Background="{StaticResource FluentDarkBackgroundBrush}"
                               Foreground="{StaticResource FluentDarkPrimaryTextBrush}"
                               BorderBrush="{StaticResource FluentDarkBorderBrush}"
                               AutoGenerateColumns="False"
                               AllowResizingColumns="True"
                               AllowSorting="True"
                               AllowFiltering="True"
                               ColumnSizer="Star"
                               SelectionMode="Single"
                               SelectionUnit="Row"
                               NavigationMode="Row"
                               AllowEditing="False"
                               ShowRowHeader="True"
                               EnableDataVirtualization="True"
                               HorizontalAlignment="Stretch"
                               VerticalAlignment="Stretch"
                               RowHeight="40"
                               HeaderRowHeight="45">

                    <syncfusion:SfDataGrid.Columns>
                        <syncfusion:GridTextColumn MappingName="FirstName" HeaderText="First Name" Width="120"/>
                        <syncfusion:GridTextColumn MappingName="LastName" HeaderText="Last Name" Width="120"/>
                        <syncfusion:GridTextColumn MappingName="ContactPhone" HeaderText="Phone" Width="130"/>
                        <syncfusion:GridTextColumn MappingName="ContactEmail" HeaderText="Email" Width="200"/>
                        <syncfusion:GridDateTimeColumn MappingName="HireDate" HeaderText="Hire Date" Width="120" Pattern="ShortDate"/>
                        <syncfusion:GridDateTimeColumn MappingName="LicenseExpiryDate" HeaderText="License Expiry" Width="140" Pattern="ShortDate"/>
                        <syncfusion:GridTextColumn MappingName="Status" HeaderText="Status" Width="100"/>
                        <syncfusion:GridTextColumn MappingName="AvailableHours" HeaderText="Available Hours" Width="120"/>
                    </syncfusion:SfDataGrid.Columns>

                    <!-- Context Menu for Right-Click Actions -->
                    <syncfusion:SfDataGrid.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="View Details" Command="{Binding ViewDriverDetailsCommand}"/>
                            <MenuItem Header="Edit Driver" Command="{Binding EditDriverCommand}"/>
                            <Separator/>
                            <MenuItem Header="Schedule Assignment" Command="{Binding ScheduleAssignmentCommand}"/>
                            <MenuItem Header="Generate Report" Command="{Binding GenerateDriverReportCommand}"/>
                            <Separator/>
                            <MenuItem Header="Delete Driver" Command="{Binding DeleteDriverCommand}"
                                     Foreground="{StaticResource FluentDarkErrorBrush}"/>
                        </ContextMenu>
                    </syncfusion:SfDataGrid.ContextMenu>
                </syncfusion:SfDataGrid>

                <!-- Enhanced Action Panel with Syncfusion Buttons -->
                <Grid Grid.Row="2" Margin="0,15,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Driver Status Summary -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock Text="Showing"
                                   VerticalAlignment="Center"
                                   Margin="0,0,5,0"
                                   Foreground="{StaticResource FluentDarkSecondaryTextBrush}"/>
                        <TextBlock Text="{Binding Drivers.Count, Mode=OneWay}"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"
                                   Foreground="{StaticResource FluentDarkPrimaryTextBrush}"/>
                        <TextBlock Text="of"
                                   VerticalAlignment="Center"
                                   Margin="5,0"
                                   Foreground="{StaticResource FluentDarkSecondaryTextBrush}"/>
                        <TextBlock Text="{Binding TotalDrivers, Mode=OneWay}"
                                   FontWeight="SemiBold"
                                   VerticalAlignment="Center"
                                   Foreground="{StaticResource FluentDarkPrimaryTextBrush}"/>
                        <TextBlock Text="drivers"
                                   VerticalAlignment="Center"
                                   Margin="5,0,15,0"
                                   Foreground="{StaticResource FluentDarkSecondaryTextBrush}"/>

                        <!-- License Alert Indicator -->
                        <Border Background="{StaticResource FluentDarkWarningBrush}"
                                CornerRadius="4"
                                Padding="8,4"
                                Visibility="{Binding HasExpiringLicenses, Converter={StaticResource BooleanToVisibilityConverter}}">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="⚠️" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                <TextBlock Text="{Binding LicenseExpiringCount, StringFormat='{}{0} licenses expiring soon'}"
                                          Foreground="White"
                                          FontWeight="SemiBold"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <syncfusion:ButtonAdv Label="➕ Add Driver"
                                             Command="{Binding AddDriverCommand}"
                                             Style="{StaticResource BusBuddyPrimaryButtonStyle}"
                                             syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                             Margin="5"/>
                        <syncfusion:ButtonAdv Label="✏️ Edit"
                                             Command="{Binding UpdateDriverCommand}"
                                             CommandParameter="{Binding SelectedDriver}"
                                             Style="{StaticResource BusBuddySecondaryButtonStyle}"
                                             syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                             Margin="5"/>
                        <syncfusion:ButtonAdv Label="🗑️ Delete"
                                             Command="{Binding DeleteDriverCommand}"
                                             CommandParameter="{Binding SelectedDriver}"
                                             Style="{StaticResource BusBuddyDeleteButtonStyle}"
                                             syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                             Margin="5"/>
                        <syncfusion:ButtonAdv Label="📊 Reports"
                                             Command="{Binding GenerateReportsCommand}"
                                             Style="{StaticResource BusBuddySecondaryButtonStyle}"
                                             syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                             Margin="5"/>
                    </StackPanel>
                </Grid>
            </Grid>
        </ContentControl>

        <!-- Loading Indicator -->
        <syncfusion:SfBusyIndicator Grid.RowSpan="3"
                                    IsBusy="{Binding IsLoading}"
                                    Style="{StaticResource BusBuddySfBusyIndicatorStyle}"
                                    syncfusionskin:SfSkinManager.VisualStyle="FluentDark"
                                    AnimationType="DoubleCircle"
                                    Foreground="{StaticResource FluentDarkAccentBrush}"
                                    Background="Transparent"/>

    </syncfusion:DockingManager>
</UserControl>

