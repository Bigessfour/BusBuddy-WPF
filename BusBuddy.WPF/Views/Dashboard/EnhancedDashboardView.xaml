<UserControl x:Class="BusBuddy.WPF.Views.Dashboard.EnhancedDashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:local="clr-namespace:BusBuddy.WPF.Views.Dashboard"
             xmlns:viewModels="clr-namespace:BusBuddy.WPF.ViewModels"
             xmlns:scheduleViewModels="clr-namespace:BusBuddy.WPF.ViewModels.Schedule"
             xmlns:syncfusion="http://schemas.syncfusion.com/wpf"
             xmlns:syncfusionskin="clr-namespace:Syncfusion.SfSkinManager;assembly=Syncfusion.SfSkinManager.WPF"
             xmlns:busView="clr-namespace:BusBuddy.WPF.Views.Bus"
             xmlns:driverView="clr-namespace:BusBuddy.WPF.Views.Driver"
             xmlns:routeView="clr-namespace:BusBuddy.WPF.Views.Route"
             xmlns:scheduleView="clr-namespace:BusBuddy.WPF.Views.Schedule"
             xmlns:studentView="clr-namespace:BusBuddy.WPF.Views.Student"
             xmlns:maintenanceView="clr-namespace:BusBuddy.WPF.Views.Maintenance"
             xmlns:fuelView="clr-namespace:BusBuddy.WPF.Views.Fuel"
             xmlns:activityView="clr-namespace:BusBuddy.WPF.Views.Activity"
             xmlns:views="clr-namespace:BusBuddy.WPF.Views"
             mc:Ignorable="d"
             d:DesignHeight="800" d:DesignWidth="1200"
             d:DataContext="{d:DesignInstance viewModels:DashboardViewModel}">

    <UserControl.Resources>
        <!-- DataTemplates have been moved to App.xaml for global availability -->
        <!-- Dashboard styles have been moved to global CustomStyles.xaml. -->
        <!-- All DashboardTileStyle, TileHeaderStyle, TileContentStyle, TileValueStyle, -->
        <!-- StatusIndicatorStyle, and PerformanceTileStyle are now global resources. -->
    </UserControl.Resources>

    <Grid Background="{DynamicResource SurfaceBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Professional Header with Status -->
        <Border Grid.Row="0"
                Background="{DynamicResource BrandPrimaryBrush}"
                Padding="24,16">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <Border Background="{DynamicResource BrandSchoolBusYellowBrush}"
                            Width="48" Height="48"
                            CornerRadius="12"
                            Margin="0,0,16,0">
                        <TextBlock Text="🚌"
                                  FontSize="24"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                    </Border>

                    <StackPanel VerticalAlignment="Center">
                        <TextBlock Text="Fleet Command Center"
                                  FontSize="28"
                                  FontWeight="Bold"
                                  Foreground="{DynamicResource ProfessionalTextPrimary}"/>
                        <TextBlock Text="Real-time Transportation Management Dashboard"
                                  FontSize="14"
                                  Foreground="{DynamicResource ProfessionalTextSecondary}"
                                  Margin="0,4,0,0"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Background="{DynamicResource BrandFleetGreenBrush}"
                            CornerRadius="16"
                            Padding="12,6"
                            Margin="8,0">
                        <StackPanel Orientation="Horizontal">
                            <Ellipse Width="10" Height="10"
                                    Fill="{DynamicResource ProfessionalTextPrimary}"
                                    VerticalAlignment="Center"
                                    Margin="0,0,8,0">
                                <Ellipse.Style>
                                    <Style TargetType="Ellipse">
                                        <Style.Triggers>
                                            <EventTrigger RoutedEvent="Loaded">
                                                <BeginStoryboard>
                                                    <Storyboard RepeatBehavior="Forever">
                                                        <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                        From="1.0" To="0.3" Duration="0:0:1"
                                                                        AutoReverse="True"/>
                                                    </Storyboard>
                                                </BeginStoryboard>
                                            </EventTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Ellipse.Style>
                            </Ellipse>
                            <TextBlock Text="All Systems Operational"
                                      FontSize="12"
                                      FontWeight="SemiBold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>
                        </StackPanel>
                    </Border>

                    <TextBlock Text="{Binding LastUpdateTime, StringFormat='Last Updated: {0:HH:mm:ss}'}"
                              FontSize="11"
                              Foreground="{DynamicResource ProfessionalTextSecondary}"
                              VerticalAlignment="Center"
                              Margin="16,0,0,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Professional Quick Actions Bar -->
        <Border Grid.Row="1"
                Background="{DynamicResource ProfessionalSurfaceLight}"
                Padding="24,12">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="Quick Actions"
                              FontSize="16"
                              FontWeight="SemiBold"
                              Foreground="{DynamicResource ProfessionalTextPrimary}"
                              VerticalAlignment="Center"
                              Margin="0,0,20,0"/>

                    <syncfusion:ButtonAdv Content="🚨 Emergency Alert"
                                        Style="{StaticResource EmergencyButtonAdvStyle}"
                                        Margin="8,0"/>
                    <syncfusion:ButtonAdv Content="📊 Generate Report"
                                        Style="{StaticResource PrimaryButtonAdvStyle}"
                                        Margin="8,0"/>
                    <syncfusion:ButtonAdv Content=" Quick Maintenance"
                                        Style="{StaticResource SafetyButtonAdvStyle}"
                                        Margin="8,0"/>
                    <syncfusion:ButtonAdv Content=" Student Roster"
                                        Style="{StaticResource FleetSuccessButtonAdvStyle}"
                                        Margin="8,0"/>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <syncfusion:ButtonAdv Content=""
                                        Style="{StaticResource IconButtonAdvStyle}"
                                        ToolTip="Refresh Data"
                                        Command="{Binding RefreshCommand}"
                                        Margin="4,0"/>
                    <syncfusion:ButtonAdv Content=""
                                        Style="{StaticResource IconButtonAdvStyle}"
                                        ToolTip="Dashboard Settings"
                                        Margin="4,0"/>
                    <syncfusion:ButtonAdv Content=""
                                        Style="{StaticResource IconButtonAdvStyle}"
                                        ToolTip="Export Dashboard"
                                        Margin="4,0"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Professional Dashboard Content -->
        <ScrollViewer Grid.Row="2"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="24,16">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>   <!-- KPI Cards Row -->
                    <RowDefinition Height="Auto"/>   <!-- Operations Row -->
                    <RowDefinition Height="Auto"/>   <!-- Live Dashboard Row -->
                    <RowDefinition Height="*"/>     <!-- Future Content Row -->
                </Grid.RowDefinitions>

                <!-- Professional KPI Cards Row -->
                <UniformGrid Grid.Row="0"
                            Rows="1"
                            Columns="4"
                            Margin="0,0,0,20">

                    <!-- Active Buses KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandPrimaryBrush}"
                            Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Active Buses"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <TextBlock Grid.Row="1"
                                      Text="{Binding ActiveBuses, FallbackValue='24'}"
                                      FontSize="48"
                                      FontWeight="Bold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="🚌" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Fleet Status: Operational"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Routes Active KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandFleetGreenBrush}"
                            Margin="5,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Active Routes"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <TextBlock Grid.Row="1"
                                      Text="{Binding ActiveRoutes, FallbackValue='18'}"
                                      FontSize="48"
                                      FontWeight="Bold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="🗺️" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Route Coverage: 95%"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Students Transported KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandSchoolBusYellowBrush}"
                            Margin="5,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Students Today"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="#1E1E1E"/>

                            <TextBlock Grid.Row="1"
                                      Text="{Binding StudentsTransported, FallbackValue='1,247'}"
                                      FontSize="48"
                                      FontWeight="Bold"
                                      Foreground="#1E1E1E"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="👨‍🎓" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Attendance: 98.3%"
                                          FontSize="12"
                                          Foreground="#2D2D30"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Safety Score KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandSafetyOrangeBrush}"
                            Margin="10,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Safety Score"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <TextBlock Grid.Row="1"
                                      Text="{Binding SafetyScore, FallbackValue='A+'}"
                                      FontSize="48"
                                      FontWeight="Bold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="🛡️" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Zero Incidents: 45 days"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </UniformGrid>

                <!-- Professional Operations Dashboard Row 2 -->
                <UniformGrid Grid.Row="1"
                            Rows="1"
                            Columns="3"
                            Margin="0,0,0,20">

                    <!-- Maintenance Status KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandSafetyOrangeBrush}"
                            Margin="0,0,10,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Maintenance Status"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <TextBlock Grid.Row="1"
                                      Text="✅ Current"
                                      FontSize="32"
                                      FontWeight="Bold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="🔧" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Next Service: 3 days"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Fuel Efficiency KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandFleetGreenBrush}"
                            Margin="5,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="Fuel Efficiency"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <TextBlock Grid.Row="1"
                                      Text="8.2L/100km"
                                      FontSize="28"
                                      FontWeight="Bold"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      HorizontalAlignment="Center"
                                      VerticalAlignment="Center"/>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="⛽" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Excellent Rating"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- System Status KPI -->
                    <Border Style="{StaticResource DashboardTileStyle}"
                            Background="{DynamicResource BrandPrimaryBrush}"
                            Margin="10,0,0,0">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0"
                                      Text="System Status"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"/>

                            <StackPanel Grid.Row="1"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center">
                                <Ellipse Width="8" Height="8"
                                        Fill="#2ECC71"
                                        HorizontalAlignment="Center"
                                        Margin="0,0,0,8">
                                    <Ellipse.RenderTransform>
                                        <ScaleTransform x:Name="PulseTransform" ScaleX="1" ScaleY="1" CenterX="4" CenterY="4"/>
                                    </Ellipse.RenderTransform>
                                    <Ellipse.Triggers>
                                        <EventTrigger RoutedEvent="Loaded">
                                            <BeginStoryboard>
                                                <Storyboard RepeatBehavior="Forever">
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PulseTransform" Storyboard.TargetProperty="ScaleX">
                                                        <EasingDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                                                        <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1.3"/>
                                                        <EasingDoubleKeyFrame KeyTime="0:0:1" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="PulseTransform" Storyboard.TargetProperty="ScaleY">
                                                        <EasingDoubleKeyFrame KeyTime="0:0:0" Value="1"/>
                                                        <EasingDoubleKeyFrame KeyTime="0:0:0.5" Value="1.3"/>
                                                        <EasingDoubleKeyFrame KeyTime="0:0:1" Value="1"/>
                                                    </DoubleAnimationUsingKeyFrames>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Ellipse.Triggers>
                                </Ellipse>
                                <TextBlock Text="ALL SYSTEMS"
                                          FontSize="18"
                                          FontWeight="Bold"
                                          Foreground="{DynamicResource ProfessionalTextPrimary}"
                                          HorizontalAlignment="Center"/>
                                <TextBlock Text="OPERATIONAL"
                                          FontSize="16"
                                          FontWeight="Bold"
                                          Foreground="{DynamicResource ProfessionalTextPrimary}"
                                          HorizontalAlignment="Center"/>
                            </StackPanel>

                            <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                                <TextBlock Text="⚡" FontSize="16" Margin="0,0,8,0"/>
                                <TextBlock Text="Performance: 98%"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </UniformGrid>

                <!-- Enhanced Real-time Dashboard Row 3 -->
                <Border Grid.Row="2"
                        Style="{StaticResource DashboardTileStyle}"
                        Background="{DynamicResource ProfessionalSurfaceDark}"
                        Margin="0,0,0,20">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <StackPanel Grid.Column="0">
                            <TextBlock Text="🔴 LIVE Dashboard"
                                      Style="{StaticResource TileHeaderStyle}"
                                      Foreground="{DynamicResource ProfessionalTextPrimary}"
                                      Margin="0,0,0,16"/>

                            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                <Border Background="{DynamicResource BrandFleetGreenBrush}"
                                        CornerRadius="12"
                                        Padding="8,4"
                                        Margin="0,0,12,0">
                                    <StackPanel Orientation="Horizontal">
                                        <Ellipse Width="8" Height="8"
                                                Fill="#FFFFFF"
                                                VerticalAlignment="Center"
                                                Margin="0,0,6,0">
                                            <Ellipse.RenderTransform>
                                                <ScaleTransform x:Name="LivePulse" ScaleX="1" ScaleY="1" CenterX="4" CenterY="4"/>
                                            </Ellipse.RenderTransform>
                                            <Ellipse.Triggers>
                                                <EventTrigger RoutedEvent="Loaded">
                                                    <BeginStoryboard>
                                                        <Storyboard RepeatBehavior="Forever">
                                                            <DoubleAnimation Storyboard.TargetName="LivePulse"
                                                                            Storyboard.TargetProperty="ScaleX"
                                                                            From="1.0" To="1.5" Duration="0:0:1"
                                                                            AutoReverse="True"/>
                                                            <DoubleAnimation Storyboard.TargetName="LivePulse"
                                                                            Storyboard.TargetProperty="ScaleY"
                                                                            From="1.0" To="1.5" Duration="0:0:1"
                                                                            AutoReverse="True"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Ellipse.Triggers>
                                        </Ellipse>
                                        <TextBlock Text="LIVE DATA"
                                                  FontSize="12"
                                                  FontWeight="Bold"
                                                  Foreground="{DynamicResource ProfessionalTextPrimary}"/>
                                    </StackPanel>
                                </Border>

                                <TextBlock Text="Auto-refresh: 5 seconds"
                                          FontSize="12"
                                          Foreground="{DynamicResource ProfessionalTextSecondary}"
                                          VerticalAlignment="Center"/>
                            </StackPanel>
                        </StackPanel>

                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                            <Border Background="#2D2D30" CornerRadius="8" Padding="12,6" Margin="0,0,12,0">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="🕒" FontSize="16" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='HH:mm:ss'}"
                                              FontSize="14" FontWeight="SemiBold"
                                              Foreground="{DynamicResource BrandPrimaryBrush}"
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                            <Border Background="#2D2D30" CornerRadius="8" Padding="12,6">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="📅" FontSize="16" VerticalAlignment="Center" Margin="0,0,6,0"/>
                                    <TextBlock Text="{Binding Source={x:Static sys:DateTime.Now}, StringFormat='MMM dd, yyyy'}"
                                              FontSize="14" FontWeight="SemiBold"
                                              Foreground="{DynamicResource BrandPrimaryBrush}"
                                              VerticalAlignment="Center"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Border>
                <!-- Future Content Placeholder -->
                <Border Grid.Row="3"
                        Style="{StaticResource DashboardTileStyle}"
                        Background="{DynamicResource ProfessionalSurfaceDark}"
                        Margin="0,0,0,20">
                    <Grid>
                        <TextBlock Text="📊 Advanced Analytics Coming Soon"
                                  Style="{StaticResource TileHeaderStyle}"
                                  Foreground="{DynamicResource ProfessionalTextSecondary}"
                                  HorizontalAlignment="Center"
                                  VerticalAlignment="Center"/>
                    </Grid>
                </Border>
            </Grid>
        </ScrollViewer>

        <!-- Main Docking Manager for Secondary Panels with Standardization -->
        <Grid Grid.Row="2">
            <syncfusion:DockingManager x:Name="MainDockingManager"
                                      Style="{StaticResource StandardDockingManagerStyle}"
                                      UseDocumentContainer="True"
                                      PersistState="True"
                                      ContainerMode="TDI"
                                      DockBehavior="VS2010"
                                      EnableAutoAdjustment="True"
                                      ShowTabItemsInTitleBar="True">

            <!-- Dashboard Overview Panel (Document) -->
            <ContentControl x:Name="DashboardOverview"
                          syncfusion:DockingManager.Header="Dashboard Overview"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                    <!-- Custom Tile Dashboard Implementation -->
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Enhanced Quick Stats Tiles Row 1 -->
                        <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,20">
                            <!-- Enhanced Fleet Summary Tile -->
                            <Border x:Name="FleetStatusTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="🚌 Fleet Status" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#2ECC71" DockPanel.Dock="Right" ToolTip="System Online"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total Buses:" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="{Binding TotalBuses}" Style="{DynamicResource TileValueStyle}"/>
                                            <TextBlock Text="{Binding FleetActivePercentageFormatted, StringFormat='Active: {0}'}"
                                                      Style="{DynamicResource TileContentStyle}" Margin="0,8,0,0" FontWeight="SemiBold"/>
                                        </StackPanel>

                                        <!-- Syncfusion Circular Progress for Fleet Status -->
                                        <syncfusion:SfCircularProgressBar Grid.Column="1"
                                                                        Width="70" Height="70"
                                                                        Progress="{Binding FleetActivePercentage}"
                                                                        Margin="5"
                                                                        Style="{DynamicResource BusBuddySfCircularProgressBarStyle}"
                                                                        >
                                            <syncfusion:SfCircularProgressBar.Content>
                                                <TextBlock Text="{Binding FleetActivePercentage, StringFormat='{}{0:F0}%'}" FontSize="12" FontWeight="Bold"
                                                         HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                            </syncfusion:SfCircularProgressBar.Content>
                                        </syncfusion:SfCircularProgressBar>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Enhanced Driver Summary Tile -->
                            <Border x:Name="DriverManagementTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="👨‍💼 Driver Management" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#3498DB" DockPanel.Dock="Right" ToolTip="Fully Staffed"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total Drivers:" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="{Binding TotalDrivers}" Style="{DynamicResource TileValueStyle}"/>
                                            <TextBlock Text="{Binding DriverAvailabilityPercentageFormatted, StringFormat='Available: {0}'}"
                                                      Style="{DynamicResource TileContentStyle}" Margin="0,8,0,0" FontWeight="SemiBold"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                            <TextBlock Text="{Binding AvailableDriverCount}" FontSize="20" FontWeight="Bold"
                                                      Foreground="#3498DB" HorizontalAlignment="Center"/>
                                            <TextBlock Text="Available" FontSize="12" Foreground="#3498DB" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Enhanced Routes Summary Tile with Syncfusion Radial Gauge -->
                            <Border x:Name="RouteNetworkTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="🗺️ Route Network" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#E67E22" DockPanel.Dock="Right" ToolTip="Optimized Coverage"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Active Routes:" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="{Binding TotalActiveRoutes}" Style="{DynamicResource TileValueStyle}"/>
                                            <TextBlock Text="{Binding RouteCoveragePercentageFormatted, StringFormat='Coverage: {0}'}"
                                                      Style="{DynamicResource TileContentStyle}" Margin="0,8,0,0" FontWeight="SemiBold"/>
                                        </StackPanel>

                                        <!-- Syncfusion Radial Gauge for Route Coverage -->
                                        <syncfusion:SfCircularGauge Grid.Column="1" Width="60" Height="60" Margin="10,0,0,0" >
                                            <syncfusion:SfCircularGauge.Scales>
                                                <syncfusion:CircularScale StartAngle="135" SweepAngle="270"
                                                                   StartValue="0" EndValue="100"
                                                                   Interval="25" ShowTicks="False"
                                                                   ShowLabels="False"
                                                                   RimStroke="#323130" RimStrokeThickness="6">
                                                    <syncfusion:CircularScale.Pointers>
                                                        <syncfusion:CircularPointer NeedlePointerType="Triangle"
                                                                             PointerCapStroke="#FF8C00"
                                                                             NeedlePointerStroke="#FF8C00"
                                                                             Value="{Binding RouteCoveragePercentage}"/>
                                                    </syncfusion:CircularScale.Pointers>
                                                    <syncfusion:CircularScale.Ranges>
                                                        <syncfusion:CircularRange StartValue="0" EndValue="100"
                                                                           Stroke="#FF8C00" StrokeThickness="6"/>
                                                    </syncfusion:CircularScale.Ranges>
                                                </syncfusion:CircularScale>
                                            </syncfusion:SfCircularGauge.Scales>
                                            <syncfusion:SfCircularGauge.Annotations>
                                                <syncfusion:GaugeAnnotation>
                                                    <syncfusion:GaugeAnnotation.Content>
                                                        <TextBlock Text="{Binding RouteCoveragePercentage, StringFormat='{}{0:F0}%'}"
                                                                  FontSize="12"
                                                                  FontWeight="Bold"
                                                                  Foreground="#FF8C00"
                                                                  HorizontalAlignment="Center"
                                                                  VerticalAlignment="Center"/>
                                                    </syncfusion:GaugeAnnotation.Content>
                                                </syncfusion:GaugeAnnotation>
                                            </syncfusion:SfCircularGauge.Annotations>
                                        </syncfusion:SfCircularGauge>
                                    </Grid>
                                </StackPanel>
                            </Border>

        <!-- Enhanced Performance Tile with Syncfusion Gauge -->
                            <Border x:Name="SystemPerformanceTile"
                                   Style="{DynamicResource PerformanceTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="⚡ System Performance" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#2ECC71" DockPanel.Dock="Right" ToolTip="Excellent Performance"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Response Time:" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="{Binding InitializationTimeFormatted}" Style="{DynamicResource TileValueStyle}" FontSize="20"/>
                                            <TextBlock Text="Next Update:" Style="{DynamicResource TileContentStyle}" Margin="0,5,0,0"/>
                                            <TextBlock Text="{Binding NextUpdateTime}" FontSize="12" FontWeight="SemiBold" Foreground="#007ACC"/>
                                        </StackPanel>

                                        <!-- Syncfusion Circular Gauge for Performance -->
                                        <syncfusion:SfCircularGauge Grid.Column="1" Width="80" Height="80" Margin="10,0,0,0" >
                                            <syncfusion:SfCircularGauge.Scales>
                                                <syncfusion:CircularScale StartAngle="135" SweepAngle="270"
                                                                   StartValue="0" EndValue="100"
                                                                   Interval="20" MinorTicksPerInterval="1"
                                                                   RimStroke="#323130" RimStrokeThickness="8"
                                                                   TickStroke="{DynamicResource SecondaryForeground}" TickStrokeThickness="1"
                                                                   LabelStroke="Transparent">
                                                    <syncfusion:CircularScale.Pointers>
                                                        <syncfusion:CircularPointer NeedlePointerType="Triangle"
                                                                             PointerCapStroke="#0078D4"
                                                                             NeedlePointerStroke="#0078D4"
                                                                             Value="{Binding SystemPerformanceScore}"/>
                                                    </syncfusion:CircularScale.Pointers>
                                                    <syncfusion:CircularScale.Ranges>
                                                        <syncfusion:CircularRange StartValue="0" EndValue="50"
                                                                           Stroke="#E74856" StrokeThickness="8"/>
                                                        <syncfusion:CircularRange StartValue="50" EndValue="75"
                                                                           Stroke="#FF8C00" StrokeThickness="8"/>
                                                        <syncfusion:CircularRange StartValue="75" EndValue="100"
                                                                           Stroke="#2ECC71" StrokeThickness="8"/>
                                                    </syncfusion:CircularScale.Ranges>
                                                </syncfusion:CircularScale>
                                            </syncfusion:SfCircularGauge.Scales>
                                        </syncfusion:SfCircularGauge>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- Enhanced Operations Tiles Row 2 -->
                        <UniformGrid Grid.Row="1" Columns="3" Margin="0,0,0,20">
                            <!-- Enhanced Maintenance Tile with Syncfusion Progress -->
                            <Border x:Name="MaintenanceHubTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="🔧 Maintenance Hub" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#F39C12" DockPanel.Dock="Right" ToolTip="Maintenance Scheduled"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="60"/>
                                        </Grid.RowDefinitions>

                                        <StackPanel Grid.Row="0">
                                            <TextBlock Text="Pending Items: 3" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold"/>
                                            <TextBlock Text="Next Service: {Binding NextServiceBus}" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="Due: {Binding NextServiceDue}" Style="{DynamicResource TileValueStyle}" FontSize="16" Foreground="#E74C3C"/>
                                        </StackPanel>

                                        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,10,0,10">
                                            <Border Background="#2ECC71" CornerRadius="3" Padding="8,4" Margin="0,0,8,0">
                                                <TextBlock Text="2 Complete" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                            </Border>
                                            <Border Background="#E74C3C" CornerRadius="3" Padding="8,4">
                                                <TextBlock Text="3 Pending" Foreground="White" FontSize="12" FontWeight="SemiBold"/>
                                            </Border>
                                        </StackPanel>

                                        <!-- Syncfusion Circular ProgressBar for Maintenance -->
                                        <syncfusion:SfCircularProgressBar Grid.Row="2"
                                                                        Width="55" Height="55"
                                                                        HorizontalAlignment="Center"
                                                                        Progress="{Binding MaintenanceCompletionPercentage}"

                                                                        FontSize="11"/>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Enhanced Fuel Management Tile with Syncfusion ProgressBar -->
                            <Border x:Name="FuelManagementTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="⛽ Fuel Analytics" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#27AE60" DockPanel.Dock="Right" ToolTip="Fuel Efficiency Good"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="50"/>
                                        </Grid.RowDefinitions>

                                        <StackPanel Grid.Row="0">
                                            <TextBlock Text="Avg Consumption: 8.2L/100km" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="Avg Consumption: {Binding AverageFuelConsumption}" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="Monthly Budget: {Binding FuelBudgetUsedPercentage, StringFormat='{}{0}% used'}" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="Efficiency: {Binding FuelEfficiencyStatus}" Style="{DynamicResource TileValueStyle}" FontSize="16" Foreground="#27AE60"/>
                                        </StackPanel>

                                        <!-- Fuel efficiency indicator -->
                                        <StackPanel Grid.Row="1" Margin="0,10,0,0">
                                            <TextBlock Text="Budget Utilization" FontSize="12" FontWeight="SemiBold" Margin="0,0,0,5"/>
                                            <!-- Syncfusion Linear ProgressBar -->
                                            <syncfusion:SfLinearProgressBar Height="12"
                                                                           Progress="{Binding FuelBudgetUsedPercentage}"
                                                                           Style="{DynamicResource BusBuddySfLinearProgressBarStyle}"
                                                                           />
                                        </StackPanel>

                                        <!-- Efficiency Meter -->
                                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,10,0,0">
                                            <syncfusion:SfCircularGauge Width="40" Height="40" Margin="0,0,10,0" >
                                                <syncfusion:SfCircularGauge.Scales>
                                                    <syncfusion:CircularScale StartAngle="135" SweepAngle="270"
                                                                       StartValue="0" EndValue="10"
                                                                       ShowLabels="False" ShowTicks="False"
                                                                       RimStroke="#323130" RimStrokeThickness="4">
                                                        <syncfusion:CircularScale.Pointers>
                                                            <syncfusion:CircularPointer NeedlePointerType="Triangle"
                                                                                 PointerCapStroke="#2ECC71"
                                                                                 NeedlePointerStroke="#2ECC71"
                                                                                 Value="{Binding AverageFuelConsumption}"/>
                                                        </syncfusion:CircularScale.Pointers>
                                                        <syncfusion:CircularScale.Ranges>
                                                            <syncfusion:CircularRange StartValue="0" EndValue="10"
                                                                               Stroke="#2ECC71" StrokeThickness="4"/>
                                                        </syncfusion:CircularScale.Ranges>
                                                    </syncfusion:CircularScale>
                                                </syncfusion:SfCircularGauge.Scales>
                                            </syncfusion:SfCircularGauge>
                                            <StackPanel VerticalAlignment="Center">
                                                <TextBlock Text="8.2 L/100km" FontSize="12" FontWeight="SemiBold" Foreground="#27AE60"/>
                                                <TextBlock Text="{Binding AverageFuelConsumption, StringFormat='{}{0} L/100km'}" FontSize="12" FontWeight="SemiBold" Foreground="#27AE60"/>
                                                <TextBlock Text="Efficiency" FontSize="10" Foreground="#666666"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </Grid>
                                </StackPanel>
                            </Border>

                            <!-- Enhanced Student Management Tile with Syncfusion Gauge -->
                            <Border x:Name="StudentTransportTile"
                                   Style="{DynamicResource DashboardTileStyle}"
                                   Cursor="Hand"
                                   MouseLeftButtonDown="DashboardTile_MouseLeftButtonDown">
                                <StackPanel>
                                    <DockPanel>
                                        <TextBlock Text="🎓 Student Transport" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#9B59B6" DockPanel.Dock="Right" ToolTip="All Students Accounted"/>
                                    </DockPanel>
                                    <Grid Margin="0,10,0,0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Total Enrolled: {Binding TotalEnrolledStudents}" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="Active Today: {Binding ActiveStudentsToday}" Style="{DynamicResource TileContentStyle}"/>
                                            <TextBlock Text="{Binding StudentCoverageStatus}" Style="{DynamicResource TileContentStyle}"
                                                      FontWeight="SemiBold" Foreground="#27AE60" Margin="0,8,0,0"/>
                                        </StackPanel>

                                        <!-- Syncfusion Circular Gauge for Attendance -->
                                        <syncfusion:SfCircularGauge Grid.Column="1" Width="70" Height="70" Margin="10,0,0,0" >
                                            <syncfusion:SfCircularGauge.Scales>
                                                <syncfusion:CircularScale StartAngle="135" SweepAngle="270"
                                                                   StartValue="0" EndValue="100"
                                                                   Interval="25" ShowTicks="False"
                                                                   ShowLabels="False"
                                                                   RimStroke="#323130" RimStrokeThickness="6">
                                                    <syncfusion:CircularScale.Pointers>
                                                        <syncfusion:CircularPointer NeedlePointerType="Triangle"
                                                                             PointerCapStroke="#0078D4"
                                                                             NeedlePointerStroke="#0078D4"
                                                                             Value="{Binding StudentAttendancePercentage}"/>
                                                    </syncfusion:CircularScale.Pointers>
                                                    <syncfusion:CircularScale.Ranges>
                                                        <syncfusion:CircularRange StartValue="0" EndValue="100"
                                                                           Stroke="#0078D4" StrokeThickness="6"/>
                                                    </syncfusion:CircularScale.Ranges>
                                                </syncfusion:CircularScale>
                                            </syncfusion:SfCircularGauge.Scales>
                                            <syncfusion:SfCircularGauge.Annotations>
                                                <syncfusion:GaugeAnnotation>
                                                    <syncfusion:GaugeAnnotation.Content>
                                                        <StackPanel HorizontalAlignment="Center">
                                                            <TextBlock Text="95%" FontSize="14" FontWeight="Bold"
                                                                      Foreground="#0078D4" HorizontalAlignment="Center"/>
                                                            <TextBlock Text="{Binding StudentAttendancePercentage, StringFormat='{}{0:F0}%'}" FontSize="9"
                                                                      Foreground="{DynamicResource SecondaryForeground}" HorizontalAlignment="Center"/>
                                                        </StackPanel>
                                                    </syncfusion:GaugeAnnotation.Content>
                                                </syncfusion:GaugeAnnotation>
                                            </syncfusion:SfCircularGauge.Annotations>
                                        </syncfusion:SfCircularGauge>
                                    </Grid>
                                </StackPanel>
                            </Border>
                        </UniformGrid>

                        <!-- Enhanced Analytics Dashboard Row 3 -->
                        <Border Grid.Row="2" Style="{DynamicResource DashboardTileStyle}" Margin="0,0,0,20">
                            <StackPanel>
                                <DockPanel Margin="0,0,0,20">
                                    <TextBlock Text="📈 Analytics Dashboard" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                    <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                        <syncfusion:ComboBoxAdv x:Name="AnalyticsTimeRange"
                                                              Width="150" Height="30"
                                                              SelectedIndex="0"
                                                              SelectionChanged="AnalyticsFilterComboBox_SelectionChanged"
                                                              Style="{DynamicResource BusBuddyComboBoxAdvStyle}"
                                                              >
                                            <syncfusion:ComboBoxItemAdv Content="Last 7 Days"/>
                                            <syncfusion:ComboBoxItemAdv Content="Last 30 Days"/>
                                            <syncfusion:ComboBoxItemAdv Content="Last 3 Months"/>
                                            <syncfusion:ComboBoxItemAdv Content="This Year"/>
                                        </syncfusion:ComboBoxAdv>
                                        <syncfusion:ButtonAdv x:Name="RefreshAnalyticsButton"
                                                            Label="🔄 Refresh"
                                                            Width="80" Height="30"
                                                            Margin="10,0,0,0"
                                                            Click="RefreshAnalyticsButton_Click"
                                                            Style="{DynamicResource BusBuddySecondaryButtonAdvStyle}"
                                                            />
                                    </StackPanel>
                                </DockPanel>

                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>

                                    <!-- Fleet Performance Trend Chart -->
                                    <Border Grid.Column="0" Background="#F8F9FA" CornerRadius="8" Padding="15" Margin="0,0,10,0">
                                        <StackPanel>
                                            <TextBlock Text="Fleet Performance Trend" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10" Foreground="#2C3E50"/>
                                            <syncfusion:SfChart x:Name="FleetPerformanceChart"
                                                          Height="180"
                                                          MouseLeftButtonDown="Chart_MouseLeftButtonDown"
                                                          Style="{DynamicResource BusBuddySfChartStyle}"
                                                          >
                                                <syncfusion:SfChart.PrimaryAxis>
                                                    <syncfusion:CategoryAxis ShowGridLines="False"/>
                                                </syncfusion:SfChart.PrimaryAxis>
                                                <syncfusion:SfChart.SecondaryAxis>
                                                    <syncfusion:NumericalAxis ShowGridLines="True"/>
                                                </syncfusion:SfChart.SecondaryAxis>
                                                <syncfusion:SfChart.Series>
                                                    <syncfusion:SplineAreaSeries ItemsSource="{Binding FleetPerformanceData}"
                                                                          XBindingPath="Period"
                                                                          YBindingPath="Performance"
                                                                          StrokeThickness="2"
                                                                          Stroke="{DynamicResource InfoBrush}">
                                                        <syncfusion:SplineAreaSeries.Interior>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                <GradientStop Color="{DynamicResource InfoColor}" Offset="0"/>
                                                                <GradientStop Color="{DynamicResource PrimaryColor}" Offset="1"/>
                                                            </LinearGradientBrush>
                                                        </syncfusion:SplineAreaSeries.Interior>
                                                    </syncfusion:SplineAreaSeries>
                                                </syncfusion:SfChart.Series>
                                            </syncfusion:SfChart>
                                        </StackPanel>
                                    </Border>

                                    <!-- Route Efficiency Chart -->
                                    <Border Grid.Column="1" Background="#F8F9FA" CornerRadius="8" Padding="15" Margin="5,0">
                                        <StackPanel>
                                            <TextBlock Text="Route Efficiency Analysis" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10" Foreground="#2C3E50"/>
                                            <syncfusion:SfChart x:Name="RouteEfficiencyChart"
                                                          Height="180"
                                                          MouseLeftButtonDown="Chart_MouseLeftButtonDown"
                                                          Style="{DynamicResource BusBuddySfChartStyle}"
                                                          >
                                                <syncfusion:SfChart.PrimaryAxis>
                                                    <syncfusion:CategoryAxis ShowGridLines="False"/>
                                                </syncfusion:SfChart.PrimaryAxis>
                                                <syncfusion:SfChart.SecondaryAxis>
                                                    <syncfusion:NumericalAxis ShowGridLines="True"/>
                                                </syncfusion:SfChart.SecondaryAxis>
                                                <syncfusion:SfChart.Series>
                                                    <syncfusion:ColumnSeries ItemsSource="{Binding RouteEfficiencyData}"
                                                                      XBindingPath="Route"
                                                                      YBindingPath="Efficiency">
                                                        <syncfusion:ColumnSeries.Interior>
                                                            <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                                <GradientStop Color="{DynamicResource WarningColor}" Offset="0"/>
                                                                <GradientStop Color="{DynamicResource PrimaryColor}" Offset="1"/>
                                                            </LinearGradientBrush>
                                                        </syncfusion:ColumnSeries.Interior>
                                                    </syncfusion:ColumnSeries>
                                                </syncfusion:SfChart.Series>
                                            </syncfusion:SfChart>
                                        </StackPanel>
                                    </Border>

                                    <!-- Resource Utilization Gauge -->
                                    <Border Grid.Column="2" Background="#F8F9FA" CornerRadius="8" Padding="15" Margin="10,0,0,0">
                                        <StackPanel>
                                            <TextBlock Text="Resource Utilization" FontWeight="SemiBold" FontSize="14" Margin="0,0,0,10" Foreground="#2C3E50"/>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition Height="*"/>
                                                    <RowDefinition Height="Auto"/>
                                                </Grid.RowDefinitions>

                                                <!-- Advanced Syncfusion Circular Gauge -->
                                                <syncfusion:SfCircularGauge Grid.Row="0" Width="150" Height="150" >
                                                    <syncfusion:SfCircularGauge.Scales>
                                                        <syncfusion:CircularScale StartAngle="135" SweepAngle="270"
                                                                           StartValue="0" EndValue="100"
                                                                           Interval="10" MinorTicksPerInterval="1"
                                                                           RimStroke="#323130" RimStrokeThickness="10"
                                                                           TickStroke="{DynamicResource SecondaryForeground}" TickStrokeThickness="1"
                                                                           LabelStroke="{DynamicResource Foreground}">
                                                            <syncfusion:CircularScale.Pointers>
                                                                <syncfusion:CircularPointer NeedlePointerType="Triangle"
                                                                                     PointerCapStroke="#0078D4"
                                                                                     NeedlePointerStroke="#0078D4"
                                                                                     Value="{Binding ResourceUtilizationPercentage}"/>
                                                            </syncfusion:CircularScale.Pointers>
                                                            <syncfusion:CircularScale.Ranges>
                                                                <syncfusion:CircularRange StartValue="0" EndValue="40"
                                                                                   Stroke="#E74856" StrokeThickness="10"/>
                                                                <syncfusion:CircularRange StartValue="40" EndValue="70"
                                                                                   Stroke="#FF8C00" StrokeThickness="10"/>
                                                                <syncfusion:CircularRange StartValue="70" EndValue="100"
                                                                                   Stroke="#2ECC71" StrokeThickness="10"/>
                                                            </syncfusion:CircularScale.Ranges>
                                                        </syncfusion:CircularScale>
                                                    </syncfusion:SfCircularGauge.Scales>
                                                    <syncfusion:SfCircularGauge.Annotations>
                                                        <syncfusion:GaugeAnnotation>
                                                            <syncfusion:GaugeAnnotation.Content>
                                                                <StackPanel HorizontalAlignment="Center">
                                                                    <TextBlock Text="78%" FontSize="20" FontWeight="Bold"
                                                                              Foreground="#0078D4" HorizontalAlignment="Center"/>
                                                                    <TextBlock Text="{Binding ResourceUtilizationPercentage, StringFormat='{}{0:F0}%'}" FontSize="12"
                                                                              Foreground="{DynamicResource SecondaryForeground}" HorizontalAlignment="Center"/>
                                                                </StackPanel>
                                                            </syncfusion:GaugeAnnotation.Content>
                                                        </syncfusion:GaugeAnnotation>
                                                    </syncfusion:SfCircularGauge.Annotations>
                                                </syncfusion:SfCircularGauge>

                                                <!-- Utilization Breakdown -->
                                                <StackPanel Grid.Row="1" Margin="0,10,0,0">
                                                    <DockPanel Margin="0,2">
                                                        <Ellipse Width="8" Height="8" Fill="#2ECC71" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                                                        <TextBlock Text="Optimal: 45%" Style="{DynamicResource TileContentStyle}"
                                                                  FontSize="11" Margin="8,0,0,0" DockPanel.Dock="Left"/>
                                                    </DockPanel>
                                                    <DockPanel Margin="0,2">
                                                        <Ellipse Width="8" Height="8" Fill="#FF8C00" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                                                        <TextBlock Text="Moderate: 33%" Style="{DynamicResource TileContentStyle}"
                                                                  FontSize="11" Margin="8,0,0,0" DockPanel.Dock="Left"/>
                                                    </DockPanel>
                                                    <DockPanel Margin="0,2">
                                                        <Ellipse Width="8" Height="8" Fill="#E74856" VerticalAlignment="Center" DockPanel.Dock="Left"/>
                                                        <TextBlock Text="Critical: 22%" Style="{DynamicResource TileContentStyle}"
                                                                  FontSize="11" Margin="8,0,0,0" DockPanel.Dock="Left"/>
                                                    </DockPanel>
                                                </StackPanel>
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <!-- Enhanced System Status & Real-time Monitoring Row 4 -->
                        <Border Grid.Row="3" Style="{DynamicResource DashboardTileStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- System Health Column -->
                                <StackPanel Grid.Column="0" Margin="0,0,20,0">
                                    <DockPanel Margin="0,0,0,15">
                                        <TextBlock Text="📊 System Health" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#2ECC71" DockPanel.Dock="Right" ToolTip="All Systems Operational"/>
                                    </DockPanel>

                                    <StackPanel>
                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Database:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                                <Ellipse Width="8" Height="8" Fill="#2ECC71" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="Connected" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#2ECC71"/>
                                            </StackPanel>
                                        </DockPanel>

                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Services:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                                                <Ellipse Width="8" Height="8" Fill="#2ECC71" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                                <TextBlock Text="Online" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#2ECC71"/>
                                            </StackPanel>
                                        </DockPanel>

                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Last Sync:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <TextBlock Text="2 mins ago" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#3498DB" DockPanel.Dock="Right"/>
                                        </DockPanel>

                                        <!-- System Performance Gauge -->
                                        <DockPanel Margin="0,15,0,0">
                                            <TextBlock Text="Performance:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Top" Margin="0,0,0,10"/>
                                            <Border Background="#ECF0F1"
                                                   CornerRadius="4"
                                                   Height="8">
                                                <Grid>
                                                    <Border Background="#2ECC71"
                                                           CornerRadius="4"
                                                           Width="180"
                                                           HorizontalAlignment="Left"/>
                                                    <TextBlock Text="92% Optimal"
                                                              FontSize="10"
                                                              FontWeight="SemiBold"
                                                              Foreground="White"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                                </Grid>
                                            </Border>
                                        </DockPanel>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Real-time Updates Column -->
                                <StackPanel Grid.Column="1" Margin="20,0">
                                    <DockPanel Margin="0,0,0,15">
                                        <TextBlock Text="🔄 Live Dashboard" Style="{DynamicResource TileHeaderStyle}" DockPanel.Dock="Left"/>
                                        <Ellipse Style="{DynamicResource StatusIndicatorStyle}" Fill="#3498DB" DockPanel.Dock="Right" ToolTip="Auto-refresh Active">
                                            <Ellipse.RenderTransform>
                                                <RotateTransform x:Name="RefreshRotate" CenterX="6" CenterY="6"/>
                                            </Ellipse.RenderTransform>
                                            <Ellipse.Triggers>
                                                <EventTrigger RoutedEvent="Loaded">
                                                    <BeginStoryboard>
                                                        <Storyboard RepeatBehavior="Forever">
                                                            <DoubleAnimation Storyboard.TargetName="RefreshRotate"
                                                                           Storyboard.TargetProperty="Angle"
                                                                           From="0" To="360" Duration="0:0:3"/>
                                                        </Storyboard>
                                                    </BeginStoryboard>
                                                </EventTrigger>
                                            </Ellipse.Triggers>
                                        </Ellipse>
                                    </DockPanel>

                                    <StackPanel>
                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Auto-refresh:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <TextBlock Text="Enabled" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#2ECC71" DockPanel.Dock="Right"/>
                                        </DockPanel>

                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Update Interval:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <TextBlock Text="5 seconds" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#3498DB" DockPanel.Dock="Right"/>
                                        </DockPanel>

                                        <DockPanel Margin="0,0,0,8">
                                            <TextBlock Text="Next Update:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Left"/>
                                            <TextBlock Text="{Binding NextUpdateTime}" Style="{DynamicResource TileContentStyle}" FontWeight="SemiBold" Foreground="#E67E22" DockPanel.Dock="Right"/>
                                        </DockPanel>

                                        <!-- Refresh countdown indicator -->
                                        <DockPanel Margin="0,15,0,0">
                                            <TextBlock Text="Refresh Status:" Style="{DynamicResource TileContentStyle}" DockPanel.Dock="Top" Margin="0,0,0,10"/>
                                            <!-- Simple circular indicator -->
                                            <Border Background="#ECF0F1"
                                                   CornerRadius="20"
                                                   Width="40" Height="40"
                                                   HorizontalAlignment="Center">
                                                <Grid>
                                                    <Ellipse Width="32" Height="32"
                                                            Stroke="#3498DB"
                                                            StrokeThickness="3"
                                                            StrokeDashArray="2.5,1">
                                                        <Ellipse.RenderTransform>
                                                            <RotateTransform x:Name="LiveIndicator" CenterX="16" CenterY="16"/>
                                                        </Ellipse.RenderTransform>
                                                        <Ellipse.Triggers>
                                                            <EventTrigger RoutedEvent="Loaded">
                                                                <BeginStoryboard>
                                                                    <Storyboard RepeatBehavior="Forever">
                                                                        <DoubleAnimation Storyboard.TargetName="LiveIndicator"
                                                                                       Storyboard.TargetProperty="Angle"
                                                                                       From="0" To="360" Duration="0:0:2"/>
                                                                    </Storyboard>
                                                                </BeginStoryboard>
                                                            </EventTrigger>
                                                        </Ellipse.Triggers>
                                                    </Ellipse>
                                                    <TextBlock Text="LIVE"
                                                              FontSize="10"
                                                              FontWeight="Bold"
                                                              Foreground="#3498DB"
                                                              HorizontalAlignment="Center"
                                                              VerticalAlignment="Center"/>
                                                </Grid>
                                            </Border>
                                        </DockPanel>
                                    </StackPanel>
                                </StackPanel>

                                <!-- Quick Actions Column -->
                                <StackPanel Grid.Column="2" Margin="20,0,0,0">
                                    <TextBlock Text="⚡ Quick Actions" Style="{DynamicResource TileHeaderStyle}" Margin="0,0,0,15"/>

                                    <StackPanel>
                                        <Border Background="{DynamicResource InfoBrush}"
                                               CornerRadius="6"
                                               Margin="0,0,0,10">
                                            <syncfusion:ButtonAdv x:Name="RefreshDataButton"
                                                   Label="🔄 Refresh Data"
                                                   Background="Transparent"
                                                   Foreground="{DynamicResource Foreground}"
                                                   BorderThickness="0"
                                                   Padding="12,8"
                                                   FontWeight="SemiBold"
                                                   Cursor="Hand"
                                                   Click="RefreshDataButton_Click"
                                                   />
                                        </Border>

                                        <Border Background="#0078D4"
                                               CornerRadius="6"
                                               Margin="0,0,0,10">
                                            <syncfusion:ButtonAdv x:Name="ViewReportsButton"
                                                   Label="📊 View Reports"
                                                   Background="Transparent"
                                                   Foreground="{DynamicResource Foreground}"
                                                   BorderThickness="0"
                                                   Padding="12,8"
                                                   FontWeight="SemiBold"
                                                   Cursor="Hand"
                                                   Click="ViewReportsButton_Click"
                                                   />
                                        </Border>

                                        <Border Background="#252526"
                                               CornerRadius="6"
                                               Margin="0,0,0,10">
                                            <syncfusion:ButtonAdv x:Name="DashboardSettingsButton"
                                                   Label="⚙️ Settings"
                                                   Background="Transparent"
                                                   Foreground="{DynamicResource Foreground}"
                                                   BorderThickness="0"
                                                   Padding="12,8"
                                                   FontWeight="SemiBold"
                                                   Cursor="Hand"
                                                   Click="SettingsButton_Click"
                                                   />
                                        </Border>

                                        <!-- System uptime indicator -->
                                        <Border CornerRadius="6"
                                               BorderBrush="#27AE60"
                                               BorderThickness="1"
                                               Padding="10"
                                               Margin="0,15,0,0">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0,0" EndPoint="0,1">
                                                    <GradientStop Color="#E8F6F3" Offset="0"/>
                                                    <GradientStop Color="#D5F4E6" Offset="1"/>
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <StackPanel>
                                                <TextBlock Text="System Uptime" FontSize="12" FontWeight="SemiBold" Foreground="#27AE60" HorizontalAlignment="Center"/>
                                                <TextBlock Text="99.8%" FontSize="18" FontWeight="Bold" Foreground="#27AE60" HorizontalAlignment="Center"/>
                                                <TextBlock Text="Excellent" FontSize="10" Foreground="#27AE60" HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Border>
                                    </StackPanel>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </Grid>
                </ScrollViewer>
            </ContentControl>

            <!-- Bus Management Panel (Docked Right) -->
            <ContentControl x:Name="BusManagement"
                          syncfusion:DockingManager.Header="Bus Management"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Right"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="350"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          />

            <!-- Driver Management Panel (Docked Left) -->
            <ContentControl x:Name="DriverManagement"
                          syncfusion:DockingManager.Header="Driver Management"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Left"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="300"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          />

            <!-- Route Management Panel (Document Tab) -->
            <ContentControl x:Name="RouteManagement"
                          syncfusion:DockingManager.Header="Route Management"
                          syncfusion:DockingManager.State="Document"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          />

            <!-- Schedule Management Panel (Auto Hidden) -->
            <ContentControl x:Name="ScheduleManagement"
                          syncfusion:DockingManager.Header="Schedule Management"
                          syncfusion:DockingManager.State="AutoHidden"
                          syncfusion:DockingManager.SideInDockedMode="Bottom"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <TextBlock Text="Schedule Management"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             FontSize="16"
                             Foreground="{DynamicResource SecondaryForeground}"/>
                </Grid>
            </ContentControl>

            <!-- Student Management Panel (Docked Bottom) -->
            <ContentControl x:Name="StudentManagement"
                          syncfusion:DockingManager.Header="Student Management"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Bottom"
                          syncfusion:DockingManager.DesiredHeightInDockedMode="200"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <TextBlock Text="Student Management"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             FontSize="16"
                             Foreground="{DynamicResource SecondaryForeground}"/>
                </Grid>
            </ContentControl>

            <!-- Maintenance Tracking Panel (Tabbed with Student Management) -->
            <ContentControl x:Name="MaintenanceTracking"
                          syncfusion:DockingManager.Header="Maintenance Tracking"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Tabbed"
                          syncfusion:DockingManager.TargetNameInDockedMode="StudentManagement"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <TextBlock Text="Maintenance Tracking"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             FontSize="16"
                             Foreground="{DynamicResource SecondaryForeground}"/>
                </Grid>
            </ContentControl>

            <!-- Fuel Management Panel (Float) -->
            <ContentControl x:Name="FuelManagement"
                          syncfusion:DockingManager.Header="Fuel Management"
                          syncfusion:DockingManager.State="Float"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <TextBlock Text="Fuel Management"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             FontSize="16"
                             Foreground="{DynamicResource SecondaryForeground}"/>
                </Grid>
            </ContentControl>

            <!-- Activity Logging Panel (Auto Hidden) -->
            <ContentControl x:Name="ActivityLogging"
                          syncfusion:DockingManager.Header="Activity Logging"
                          syncfusion:DockingManager.State="AutoHidden"
                          syncfusion:DockingManager.SideInDockedMode="Right"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <TextBlock Text="Activity Logging"
                             HorizontalAlignment="Center"
                             VerticalAlignment="Center"
                             FontSize="16"
                             Foreground="{DynamicResource SecondaryForeground}"/>
                </Grid>
            </ContentControl>

            <!-- System Loading Panel (Auto Hidden) - NEWLY INTEGRATED -->
            <ContentControl x:Name="SystemLoadingPanel"
                          syncfusion:DockingManager.Header="⚡ System Loading"
                          syncfusion:DockingManager.State="AutoHidden"
                          syncfusion:DockingManager.SideInDockedMode="Bottom"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <views:LoadingView DataContext="{Binding LoadingViewModel, FallbackValue={x:Null}}"
                                  Margin="10"
                                  HorizontalAlignment="Stretch"
                                  VerticalAlignment="Stretch"/>
            </ContentControl>

            <!-- XAI Chat Panel (Right Docked) - NEW ENHANCEMENT -->
            <ContentControl x:Name="XAIChatPanel"
                          syncfusion:DockingManager.Header="🤖 XAI Assistant"
                          syncfusion:DockingManager.State="Dock"
                          syncfusion:DockingManager.SideInDockedMode="Right"
                          syncfusion:DockingManager.DesiredWidthInDockedMode="320"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Chat Header -->
                    <Border Grid.Row="0" Background="#2C3E50" CornerRadius="8,8,0,0" Padding="15,10" Margin="0,0,0,5">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="🤖" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                            <TextBlock Text="Bus Buddy AI Assistant" FontWeight="SemiBold" Foreground="White" VerticalAlignment="Center"/>
                            <Border Background="#27AE60" CornerRadius="6" Padding="6,2" Margin="10,0,0,0">
                                <TextBlock Text="ONLINE" FontSize="10" FontWeight="Bold" Foreground="White"/>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- Chat Control - Using RichTextBox instead of non-existent SfChat -->
                    <Border Grid.Row="1" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="0,0,8,8">
                        <Grid Margin="5">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- Chat Messages Display -->
                            <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
                                <RichTextBox x:Name="ChatMessagesBox"
                                           IsReadOnly="True"
                                           BorderThickness="0"
                                           Background="Transparent">
                                    <FlowDocument>
                                        <Paragraph>
                                            <Run Text="🤖 XAI Assistant: Hello! I'm your Bus Buddy AI Assistant. Ask me about fleet status, routes, maintenance, or anything else!"
                                                 Foreground="#2C3E50" FontWeight="SemiBold"/>
                                        </Paragraph>
                                        <Paragraph>
                                            <Run Text="📊 Quick tip: Try asking about 'fleet status' or 'route efficiency'"
                                                 Foreground="#7F8C8D"/>
                                        </Paragraph>
                                    </FlowDocument>
                                </RichTextBox>
                            </ScrollViewer>

                            <!-- Chat Input -->
                            <DockPanel Grid.Row="1" Margin="0,5,0,0">
                                <syncfusion:ButtonAdv DockPanel.Dock="Right"
                                                    Content="Send"
                                                    Width="50"
                                                    Background="#3498DB"
                                                    Foreground="White"
                                                    BorderThickness="0"
                                                    CornerRadius="4"
                                                    Margin="5,0,0,0"/>
                                <TextBox x:Name="ChatInputBox"
                                       Padding="8"
                                       Text="Type your question here..."
                                       BorderBrush="#BDC3C7"
                                       BorderThickness="1"/>
                            </DockPanel>
                        </Grid>
                    </Border>

                    <!-- Quick Actions -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <syncfusion:ButtonAdv Label="Fleet Status"
                                            Background="{DynamicResource InfoBrush}"
                                            Foreground="{DynamicResource Foreground}"
                                            BorderThickness="0"
                                            CornerRadius="4"
                                            Padding="8,4"
                                            FontSize="10"
                                            Margin="0,0,5,0"
                                            />
                        <syncfusion:ButtonAdv Label="Route Info"
                                            Background="#FF8C00"
                                            Foreground="{DynamicResource Foreground}"
                                            BorderThickness="0"
                                            CornerRadius="4"
                                            Padding="8,4"
                                            FontSize="10"
                                            Margin="0,0,5,0"
                                            />
                        <syncfusion:ButtonAdv Label="Maintenance"
                                            Background="#0078D4"
                                            Foreground="{DynamicResource Foreground}"
                                            BorderThickness="0"
                                            CornerRadius="4"
                                            Padding="8,4"
                                            FontSize="10"
                                            />
                    </StackPanel>
                </Grid>
            </ContentControl>

            <!-- Google Earth Engine Panel (Floating) - NEW ENHANCEMENT -->
            <ContentControl x:Name="EarthEnginePanel"
                          syncfusion:DockingManager.Header="🌍 Earth Engine Maps"
                          syncfusion:DockingManager.State="Float"
                          syncfusion:DockingManager.DesiredWidthInFloatingMode="600"
                          syncfusion:DockingManager.DesiredHeightInFloatingMode="450"
                          syncfusion:DockingManager.CanSerialize="True"
                          HorizontalAlignment="Stretch"
                          VerticalAlignment="Stretch"
                          >
                <Grid Margin="10">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Map Header with Controls -->
                    <Border Grid.Row="0" Background="{DynamicResource SecondaryBackground}" CornerRadius="8,8,0,0" Padding="15,10" Margin="0,0,0,5">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Orientation="Horizontal">
                                <TextBlock Text="🌍" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                                <TextBlock Text="Route &amp; Fleet Mapping" FontWeight="SemiBold"
                                         Foreground="{DynamicResource SecondaryForeground}" VerticalAlignment="Center"/>
                            </StackPanel>

                            <StackPanel Grid.Column="1" Orientation="Horizontal">
                                <syncfusion:ComboBoxAdv Width="120" Height="25" SelectedIndex="0" Margin="0,0,10,0"
                                               Style="{DynamicResource BusBuddyComboBoxAdvStyle}"
                                               >
                                    <syncfusion:ComboBoxItemAdv Content="Satellite"/>
                                    <syncfusion:ComboBoxItemAdv Content="Terrain"/>
                                    <syncfusion:ComboBoxItemAdv Content="Roadmap"/>
                                    <syncfusion:ComboBoxItemAdv Content="Hybrid"/>
                                </syncfusion:ComboBoxAdv>
                                <syncfusion:ButtonAdv Label="🔄" Width="25" Height="25" ToolTip="Refresh Map"
                                               Style="{DynamicResource BusBuddyIconButtonAdvStyle}"
                                               />
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Map Control Placeholder -->
                    <Border Grid.Row="1" BorderBrush="#323130" BorderThickness="1" CornerRadius="0,0,8,8">
                        <Grid Background="#252526">
                            <TextBlock Text="🌍 Google Earth Engine Maps"
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"
                                     Foreground="#6C757D"
                                     FontSize="16"/>
                            <TextBlock Text="Map integration coming soon..."
                                     HorizontalAlignment="Center"
                                     VerticalAlignment="Center"
                                     Margin="0,30,0,0"
                                     FontSize="12"
                                     Foreground="#ADB5BD"/>
                        </Grid>
                    </Border>

                    <!-- Map Legend and Status -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0">
                        <Border Background="#2ECC71" Width="12" Height="12" CornerRadius="6" VerticalAlignment="Center"/>
                        <TextBlock Text="Active Routes" FontSize="11" Margin="5,0,15,0" VerticalAlignment="Center"/>
                        <Border Background="#E74C3C" Width="12" Height="12" CornerRadius="6" VerticalAlignment="Center"/>
                        <TextBlock Text="Maintenance Routes" FontSize="11" Margin="5,0,15,0" VerticalAlignment="Center"/>
                        <Border Background="#F39C12" Width="12" Height="12" CornerRadius="6" VerticalAlignment="Center"/>
                        <TextBlock Text="Bus Locations" FontSize="11" Margin="5,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                </Grid>
            </ContentControl>
            </syncfusion:DockingManager>
        </Grid>
    </Grid>
</UserControl>



